[{"id":"e2d0491f8f79674f","type":"tab","label":"TugasAkhir Agriculture","disabled":false,"info":"","env":[]},{"id":"98f7d7b939f04b80","type":"mqtt in","z":"e2d0491f8f79674f","name":"","topic":"DHT/sensor","qos":"1","datatype":"auto-detect","broker":"f02d30787e2b888d","nl":false,"rap":true,"rh":0,"inputs":0,"x":150,"y":960,"wires":[["51fb03bfac904f9d"]]},{"id":"53f09a299a785b37","type":"ui_gauge","z":"e2d0491f8f79674f","name":"Temperature","group":"c52e7deb289caa8e","order":1,"width":10,"height":4,"gtype":"gage","title":"Temperature","label":"°C","format":"{{msg.payload.valuetemperature}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"30","seg2":"50","diff":false,"className":"","x":1030,"y":400,"wires":[]},{"id":"27a998e2325d759a","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"c52e7deb289caa8e","order":2,"width":10,"height":4,"gtype":"gage","title":"Humidity","label":"%","format":"{{msg.payload.valuehumidity}}","min":0,"max":"100","colors":["#dcaaee","#b36afb","#7800a3"],"seg1":"","seg2":"","diff":false,"className":"","x":1020,"y":440,"wires":[]},{"id":"2114e71fe35c3b09","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"442a04fa8d8550a1","order":1,"width":10,"height":4,"gtype":"gage","title":"Temperature","label":"°C","format":"{{msg.payload.valuetemperature}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"30","seg2":"50","diff":false,"className":"","x":1030,"y":640,"wires":[]},{"id":"b0716083d914ef5e","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"442a04fa8d8550a1","order":2,"width":10,"height":4,"gtype":"gage","title":"Humidity","label":"%","format":"{{msg.payload.valuehumidity}}","min":0,"max":"100","colors":["#dcaaee","#b36afb","#7800a3"],"seg1":"","seg2":"","diff":false,"className":"","x":1020,"y":680,"wires":[]},{"id":"4ab3ad6c28903a38","type":"switch","z":"e2d0491f8f79674f","name":"ID1","property":"payload.value.BoardId","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":610,"y":480,"wires":[["c19a6b924604f1d0","5956025cc29b612c","cc2e8e5b76b471d3"]]},{"id":"eed962b96fb34a82","type":"switch","z":"e2d0491f8f79674f","name":"ID2","property":"payload.value.BoardId","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":610,"y":720,"wires":[["9df828248f108a58","e747cfe0aab5508f","8343031f3408f77d"]]},{"id":"eb91fccc7751600b","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":400,"y":560,"wires":[["99eefedaf97ec6b4"]]},{"id":"99eefedaf97ec6b4","type":"function","z":"e2d0491f8f79674f","name":"Add timestamp","func":"msg.payload = {value:msg.payload, datetime:Date.now()};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":600,"wires":[["4ab3ad6c28903a38","eed962b96fb34a82","837ecd47bc4ddd28"]]},{"id":"35e3b8b269bd9511","type":"ui_text","z":"e2d0491f8f79674f","group":"c52e7deb289caa8e","order":9,"width":10,"height":1,"name":"","label":"Last Updated","format":"{{msg.payload}}","layout":"row-spread","className":"","x":1250,"y":560,"wires":[]},{"id":"223e86700ede5ff0","type":"moment","z":"e2d0491f8f79674f","name":"","topic":"","input":"","inputType":"msg","inTz":"Asia/Jakarta","adjAmount":0,"adjType":"days","adjDir":"add","format":"DD.MM.YYYY HH:mm:ss","locale":"en-US","output":"","outputType":"msg","outTz":"Asia/Jakarta","x":1060,"y":560,"wires":[["35e3b8b269bd9511"]]},{"id":"46b3d3c21679352f","type":"ui_text","z":"e2d0491f8f79674f","group":"442a04fa8d8550a1","order":9,"width":10,"height":1,"name":"","label":"Last Updated","format":"{{msg.payload}}","layout":"row-spread","className":"","x":1250,"y":800,"wires":[]},{"id":"965c8157cc833301","type":"moment","z":"e2d0491f8f79674f","name":"","topic":"","input":"","inputType":"msg","inTz":"Asia/Jakarta","adjAmount":0,"adjType":"days","adjDir":"add","format":"DD.MM.YYYY HH:mm:ss","locale":"en-US","output":"","outputType":"msg","outTz":"Asia/Jakarta","x":1060,"y":800,"wires":[["46b3d3c21679352f"]]},{"id":"d13c8746de086053","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"c52e7deb289caa8e","order":5,"width":10,"height":5,"label":"chart","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Data not available","dot":false,"ymin":"0","ymax":"100","removeOlder":1,"removeOlderPoints":"20","removeOlderUnit":"60","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#199ed7","#ff9e42","#6df05c","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1010,"y":360,"wires":[["246c076b553c4cee"]]},{"id":"c19a6b924604f1d0","type":"function","z":"e2d0491f8f79674f","name":"Chart Function","func":"var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nmsg1.payload = parseFloat(msg.payload.value.temperature);\nmsg1.topic = 'Temperature';\n\nmsg2.payload = parseFloat(msg.payload.value.humidity);\nmsg2.topic = 'Humidity';\n\nmsg3.payload = parseFloat(msg.payload.value.soilhumid);\nmsg3.topic = 'Soil Humidity';\n\nmsg4.payload = parseFloat(msg.payload.value.pH);\nmsg4.topic = 'pH Value';\nreturn [msg1, msg2, msg3, msg4];","outputs":4,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":420,"wires":[["d13c8746de086053"],["d13c8746de086053"],["d13c8746de086053"],["d13c8746de086053"]]},{"id":"b5a8210dd5f054f1","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"c52e7deb289caa8e","order":7,"width":4,"height":1,"passthru":false,"label":"Clear Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"[]","payloadType":"json","topic":"topic","topicType":"msg","x":810,"y":360,"wires":[["d13c8746de086053"]]},{"id":"cc2dd0d7f2da34e1","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"442a04fa8d8550a1","order":5,"width":10,"height":5,"label":"chart","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Data not available","dot":false,"ymin":"0","ymax":"100","removeOlder":1,"removeOlderPoints":"20","removeOlderUnit":"60","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#199ed7","#ff9e42","#6df05c","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1010,"y":600,"wires":[[]]},{"id":"9df828248f108a58","type":"function","z":"e2d0491f8f79674f","name":"Chart Function","func":"var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nmsg1.payload = parseFloat(msg.payload.value.temperature);\nmsg1.topic = 'Temperature';\n\nmsg2.payload = parseFloat(msg.payload.value.humidity);\nmsg2.topic = 'Humidity';\n\nmsg3.payload = parseFloat(msg.payload.value.soilhumid);\nmsg3.topic = 'Soil Humidity';\n\nmsg4.payload = parseFloat(msg.payload.value.pH);\nmsg4.topic = 'pH Value';\nreturn [msg1, msg2, msg3, msg4];","outputs":4,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":660,"wires":[["cc2dd0d7f2da34e1"],["cc2dd0d7f2da34e1"],["cc2dd0d7f2da34e1"],["cc2dd0d7f2da34e1"]]},{"id":"4ab3e95b1ccc7e92","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"442a04fa8d8550a1","order":7,"width":4,"height":1,"passthru":false,"label":"Clear Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"[]","payloadType":"json","topic":"topic","topicType":"msg","x":790,"y":600,"wires":[["cc2dd0d7f2da34e1"]]},{"id":"20309ee706c350cc","type":"comment","z":"e2d0491f8f79674f","name":"Average Value","info":"","x":1680,"y":140,"wires":[]},{"id":"efed49ebd49f8d24","type":"function","z":"e2d0491f8f79674f","name":"Rolling Average Temperature","func":"var currentTime = new Date().getTime();\nif (!context.lastTime) {\n    context.lastTime = currentTime;\n    context.sum = msg.payload.value;\n    context.count = 1;\n}\nif (currentTime - context.lastTime > 30000) {\n    // calculate average for previous messages\n    msg.payload.averagetemp = context.sum / context.count;\n    // start tracking average again\n    context.sum = msg.payload.value;\n    context.count = 1;\n    context.lastTime = currentTime;\n} else {\n    context.sum += msg.payload.value;\n    context.count += 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2240,"y":280,"wires":[["40f79e3bab903ace","eaeb02a6f7af0ab2","6ff5293ba93e73c4"]]},{"id":"300542d1ab9aae26","type":"function","z":"e2d0491f8f79674f","name":"Rolling Average Humidity","func":"var currentTime = new Date().getTime();\nif (!context.lastTime) {\n    context.lastTime = currentTime;\n    context.sum = msg.payload.value;\n    context.count = 1;\n}\nif (currentTime - context.lastTime > 30000) {\n    // calculate average for previous messages\n    msg.payload.averagehum = context.sum / context.count;\n    // start tracking average again\n    context.sum = msg.payload.value;\n    context.count = 1;\n    context.lastTime = currentTime;\n} else {\n    context.sum += msg.payload.value;\n    context.count += 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":180,"wires":[["791bb4855de01ab9","6ff5293ba93e73c4"]]},{"id":"bca161b48c01b79b","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":2,"width":7,"height":4,"gtype":"gage","title":"Temperature","label":"°C","format":"{{msg.payload.averagetemp}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"30","seg2":"50","diff":false,"className":"","x":3010,"y":260,"wires":[]},{"id":"de6f61eba95df847","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":3,"width":7,"height":4,"gtype":"gage","title":"Humidity","label":"%","format":"{{msg.payload.averagehum}}","min":0,"max":"100","colors":["#dcaaee","#b36afb","#7800a3"],"seg1":"","seg2":"","diff":false,"className":"","x":3000,"y":180,"wires":[]},{"id":"012e63c38b78743a","type":"function","z":"e2d0491f8f79674f","name":"Datetime Extract","func":"msg.payload = parseFloat(msg.payload.datetime)\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2720,"y":140,"wires":[["d981de2c96c85994"]]},{"id":"9e6525e74af95a2c","type":"ui_text","z":"e2d0491f8f79674f","group":"62db7c629df26146","order":18,"width":8,"height":1,"name":"","label":"Last Updated","format":"{{msg.payload}}","layout":"row-spread","className":"","x":3130,"y":140,"wires":[]},{"id":"d981de2c96c85994","type":"moment","z":"e2d0491f8f79674f","name":"","topic":"","input":"","inputType":"msg","inTz":"Asia/Jakarta","adjAmount":0,"adjType":"days","adjDir":"add","format":"DD.MM.YYYY HH:mm:ss","locale":"en-US","output":"","outputType":"msg","outTz":"Asia/Jakarta","x":2940,"y":140,"wires":[["9e6525e74af95a2c"]]},{"id":"452bde95249c3782","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2200,"y":220,"wires":[["791bb4855de01ab9"]]},{"id":"e58e612fda332b05","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":17,"width":30,"height":6,"label":"Average Value","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Data not available","dot":false,"ymin":"0","ymax":"100","removeOlder":1,"removeOlderPoints":"300","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#199ed7","#ff9e42","#6df05c","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":3820,"y":320,"wires":[["c7cc344e405bf655","e31ab4d9b64772a0","183ec7aa3a296ea5"]]},{"id":"40f79e3bab903ace","type":"function","z":"e2d0491f8f79674f","name":"Chart Function","func":"var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nif (msg.payload.averagetemp || msg.payload.value.averagehum || msg.payload.averagesoilhumid || msg.payload.averagepH) {\n    msg1.payload = Math.round(parseFloat(msg.payload.averagetemp) * 10) / 10;\n    msg1.topic = 'Temperature';\n    msg2.payload = Math.round(parseFloat(msg.payload.value.averagehum) * 10) / 10;\n    msg2.topic = 'Humidity';\n    msg3.payload = Math.round(parseFloat(msg.payload.averagesoilhumid) * 10) / 10;\n    msg3.topic = 'Soil Humidity';\n    msg4.payload = Math.round(parseFloat(msg.payload.averagepH) * 10) / 10;\n    msg4.topic = 'pH Value';\n    return [msg1, msg2, msg3, msg4];\n} else { return 0; }\n","outputs":4,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3620,"y":300,"wires":[["e58e612fda332b05"],["e58e612fda332b05"],["e58e612fda332b05"],["e58e612fda332b05"]]},{"id":"01f250b887a5b5a2","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":20,"width":4,"height":1,"passthru":false,"label":"Clear Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"[]","payloadType":"json","topic":"topic","topicType":"msg","x":3610,"y":360,"wires":[["e58e612fda332b05"]]},{"id":"3855c65d4a4b21b7","type":"function","z":"e2d0491f8f79674f","name":"Temperature Validation","func":"if (!msg.payload.temperature) {\n    msg.payload.temperature = 0;\n}\nmsg.payload = {\n    value: msg.payload.temperature,\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1960,"y":280,"wires":[["efed49ebd49f8d24"]]},{"id":"4af765e829dad5ce","type":"function","z":"e2d0491f8f79674f","name":"Humidity Validation","func":"if (!msg.payload.humidity) {\n    msg.payload.humidity = 0;\n}\nmsg.payload = {\n    value: msg.payload.humidity\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1950,"y":180,"wires":[["300542d1ab9aae26"]]},{"id":"eaeb02a6f7af0ab2","type":"function","z":"e2d0491f8f79674f","name":"Averagetemp Float Extract","func":"if(msg.payload.averagetemp){\n    msg.payload.averagetemp = Math.round(parseFloat(msg.payload.averagetemp) * 10) / 10;\nreturn msg;\n}else{return 0;}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2760,"y":280,"wires":[["bca161b48c01b79b","30a8d330be816071","55767e218733b054"]]},{"id":"e60f084598b4b335","type":"function","z":"e2d0491f8f79674f","name":"Averagehumid Float Extract","func":"if(msg.payload.value.averagehum){\n    msg.payload.averagehum = Math.round(parseFloat(msg.payload.value.averagehum) * 10) / 10;\nreturn msg;\n}else{return 0;}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2760,"y":200,"wires":[["de6f61eba95df847","ce7b807acd540a6e","55767e218733b054"]]},{"id":"791bb4855de01ab9","type":"function","z":"e2d0491f8f79674f","name":"Inject Timestamp","func":"if(msg.payload.averagehum){\nmsg.payload = {value:msg.payload, datetime:Date.now()};\nreturn msg;}\nelse{return 0}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2510,"y":180,"wires":[["e60f084598b4b335","40f79e3bab903ace","012e63c38b78743a"]]},{"id":"a8efed8b376d1a8e","type":"comment","z":"e2d0491f8f79674f","name":"Board Info","info":"","x":180,"y":120,"wires":[]},{"id":"e5744f895b421d1f","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"c52e7deb289caa8e","order":3,"width":10,"height":4,"gtype":"gage","title":"Soil Humidity","label":"%","format":"{{msg.payload.valuesoil}}","min":0,"max":"100","colors":["#aad4ee","#6aa9fb","#005ca3"],"seg1":"","seg2":"","diff":false,"className":"","x":1030,"y":480,"wires":[]},{"id":"c34d7a57bfa5a994","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"442a04fa8d8550a1","order":3,"width":10,"height":4,"gtype":"gage","title":"Soil Humidity","label":"%","format":"{{msg.payload.valuesoil}}","min":0,"max":"100","colors":["#aad4ee","#6aa9fb","#005ca3"],"seg1":"","seg2":"","diff":false,"className":"","x":1030,"y":720,"wires":[]},{"id":"1db9cd3823b459f8","type":"function","z":"e2d0491f8f79674f","name":"Rolling Average Soil Humidity","func":"var currentTime = new Date().getTime();\nif (!context.lastTime) {\n    context.lastTime = currentTime;\n    context.sum = msg.payload.value;\n    context.count = 1;\n}\nif (currentTime - context.lastTime > 30000) {\n    // calculate average for previous messages\n    msg.payload.averagesoilhumid = context.sum / context.count;\n    // start tracking average again\n    context.sum = msg.payload.value;\n    context.count = 1;\n    context.lastTime = currentTime;\n} else {\n    context.sum += msg.payload.value;\n    context.count += 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2240,"y":360,"wires":[["14dc908011abd625","40f79e3bab903ace","6ff5293ba93e73c4"]]},{"id":"ca7a6c83f3dac33b","type":"function","z":"e2d0491f8f79674f","name":"Soil Humidity Validation","func":"if (!msg.payload.soilhumid) {\n    msg.payload.soilhumid = 0;\n}\nmsg.payload = {\n    value: msg.payload.soilhumid,\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1970,"y":360,"wires":[["1db9cd3823b459f8"]]},{"id":"14dc908011abd625","type":"function","z":"e2d0491f8f79674f","name":"AverageSoilhumid Float Extract","func":"if(msg.payload.averagesoilhumid){\n    msg.payload.averagesoilhumid = Math.round(parseFloat(msg.payload.averagesoilhumid) * 10) / 10;\nreturn msg;\n}else{return 0;}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2770,"y":360,"wires":[["93a55bce9b657810","c8b14bc46039a64a","55767e218733b054"]]},{"id":"93a55bce9b657810","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":4,"width":7,"height":4,"gtype":"gage","title":"Soil Humidity","label":"%","format":"{{msg.payload.averagesoilhumid}}","min":0,"max":"100","colors":["#aad4ee","#6aa9fb","#005ca3"],"seg1":"","seg2":"","diff":false,"className":"","x":3010,"y":340,"wires":[]},{"id":"c3782b5bd928ffdf","type":"remote-access","z":"e2d0491f8f79674f","confignode":"ee1ec0d4d53b54a5","name":"","verbose":0,"x":240,"y":260,"wires":[[]]},{"id":"0f0c624ef8d09984","type":"ui_toast","z":"e2d0491f8f79674f","position":"top right","displayTime":"5","highlight":"red","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1550,"y":1800,"wires":[]},{"id":"0a32647a25594843","type":"change","z":"e2d0491f8f79674f","name":"Not Valid","rules":[{"t":"set","p":"topic","pt":"msg","to":"Invalid Value","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"Input Between 7-10","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":1860,"wires":[["0f0c624ef8d09984"]]},{"id":"1eb1498a30f0406d","type":"change","z":"e2d0491f8f79674f","name":"Not Valid","rules":[{"t":"set","p":"topic","pt":"msg","to":"Invalid Value","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"Input Between 1-7","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":1740,"wires":[["0f0c624ef8d09984"]]},{"id":"1720c64a4dfd38a6","type":"ui_led","z":"e2d0491f8f79674f","order":2,"group":"d0d4883bc2e966fc","width":1,"height":1,"label":"","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"#ff0000","value":"true","valueType":"bool"},{"color":"#008000","value":"false","valueType":"bool"}],"allowColorForValueInMessage":false,"shape":"circle","showGlow":true,"name":"","x":470,"y":1760,"wires":[]},{"id":"874bdd8df69930dd","type":"ui_text","z":"e2d0491f8f79674f","group":"d0d4883bc2e966fc","order":6,"width":3,"height":1,"name":"","label":"If pH <","format":"{{msg.payload.pH_bawah}}","layout":"row-right","className":"","x":1230,"y":1780,"wires":[]},{"id":"402ba37dd8b7028c","type":"ui_text","z":"e2d0491f8f79674f","group":"d0d4883bc2e966fc","order":7,"width":7,"height":1,"name":"","label":"Inject","format":"{{msg.payload.cairanbawah}} ml","layout":"row-left","className":"","x":1370,"y":1780,"wires":[]},{"id":"48acdef1141a49fe","type":"ui_text","z":"e2d0491f8f79674f","group":"d0d4883bc2e966fc","order":4,"width":3,"height":1,"name":"","label":"If pH >","format":"{{msg.payload.pH_Atas}}","layout":"row-right","className":"","x":1230,"y":1820,"wires":[]},{"id":"599d09dc4e5173a5","type":"ui_text","z":"e2d0491f8f79674f","group":"d0d4883bc2e966fc","order":5,"width":7,"height":1,"name":"","label":"Inject","format":"{{msg.payload.cairanatas}} ml","layout":"row-left","className":"","x":1370,"y":1820,"wires":[]},{"id":"e529a277c5c9adbb","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.pH_bawah","propertyType":"msg","rules":[{"t":"gt","v":"7","vt":"str"},{"t":"lte","v":"7","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1010,"y":1780,"wires":[["1eb1498a30f0406d"],["874bdd8df69930dd","402ba37dd8b7028c"]]},{"id":"a5580d7fa822be06","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.pH_Atas","propertyType":"msg","rules":[{"t":"gt","v":"7","vt":"str"},{"t":"lte","v":"7","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1010,"y":1820,"wires":[["48acdef1141a49fe","599d09dc4e5173a5"],["0a32647a25594843"]]},{"id":"a451a9fec6bc66c2","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"d0d4883bc2e966fc","order":10,"width":5,"height":1,"passthru":false,"label":"Stop Automation","tooltip":"","color":"red","bgcolor":"black","className":"","icon":"stop","payload":"true","payloadType":"bool","topic":"topic","topicType":"msg","x":200,"y":1720,"wires":[["9faf8ec81ceb8e2d","1720c64a4dfd38a6","bf9d5401a8612ecf"]]},{"id":"9bee45e5b5952a5a","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"d0d4883bc2e966fc","order":9,"width":5,"height":1,"passthru":false,"label":"Start Automation","tooltip":"","color":"green","bgcolor":"black","className":"","icon":"power_settings_new","payload":"false","payloadType":"bool","topic":"topic","topicType":"msg","x":210,"y":1800,"wires":[["2f585adc6c4a7ca0"]]},{"id":"9faf8ec81ceb8e2d","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"enabled","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":1800,"wires":[["d130abf9034b583b","248868619b3a025e"]]},{"id":"d130abf9034b583b","type":"ui_form","z":"e2d0491f8f79674f","name":"","label":"Automation Setup","group":"d0d4883bc2e966fc","order":8,"width":0,"height":0,"options":[{"label":"pH Lower Limit (2-10)","value":"pH_bawah","type":"number","required":true,"rows":null},{"label":"pH Upper Limit (2-10)","value":"pH_Atas","type":"number","required":true,"rows":null},{"label":"Inject Below (0-100) ml","value":"cairanbawah","type":"number","required":true,"rows":null},{"label":"Inject Above (0-100) ml","value":"cairanatas","type":"number","required":true,"rows":null}],"formValue":{"pH_bawah":"","pH_Atas":"","cairanbawah":"","cairanatas":""},"payload":"","submit":"Set","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":770,"y":1800,"wires":[["e529a277c5c9adbb","a5580d7fa822be06","0f77c7569d8c591f"]]},{"id":"bf9d5401a8612ecf","type":"switch","z":"e2d0491f8f79674f","name":"Automation Status","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":1720,"wires":[["bc37cacc7bed71b0","801252b7fa64bbda"],["95b6cfb307f3abf5","801252b7fa64bbda"]]},{"id":"bc37cacc7bed71b0","type":"function","z":"e2d0491f8f79674f","name":"ON","func":"msg.payload = \"ON\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":1700,"wires":[["0a490e9b2da8147e"]]},{"id":"95b6cfb307f3abf5","type":"function","z":"e2d0491f8f79674f","name":"OFF","func":"msg.payload = \"OFF\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":1740,"wires":[["0a490e9b2da8147e"]]},{"id":"0a490e9b2da8147e","type":"ui_text","z":"e2d0491f8f79674f","group":"d0d4883bc2e966fc","order":1,"width":4,"height":1,"name":"","label":"Automation Status  ","format":"{{msg.payload}}","layout":"row-left","className":"","x":930,"y":1700,"wires":[]},{"id":"1caf38bb1f3b2c26","type":"comment","z":"e2d0491f8f79674f","name":"Automation Setting","info":"","x":210,"y":1640,"wires":[]},{"id":"e0d5a81202c53254","type":"comment","z":"e2d0491f8f79674f","name":"Data Join","info":"","x":180,"y":1140,"wires":[]},{"id":"0f77c7569d8c591f","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"autosetting","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":1860,"wires":[["8c803b9bf7c35dd8"]]},{"id":"8c803b9bf7c35dd8","type":"debug","z":"e2d0491f8f79674f","name":"flow.autosetting Check","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1280,"y":1900,"wires":[]},{"id":"6ff5293ba93e73c4","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"avvalue","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":500,"wires":[[]]},{"id":"8709d4e2adfc56bf","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":850,"y":1360,"wires":[["af503dd623cf5174"]]},{"id":"70ce1251b99d2c94","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"6","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":1360,"wires":[["8709d4e2adfc56bf"]]},{"id":"a783c28f4b214a78","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1300,"wires":[["d6bda38ded21444c","6db908d530e3e82d","e622d2ec296a90fb","70ce1251b99d2c94"]]},{"id":"e3510d0237bddd82","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1260,"wires":[["d6bda38ded21444c","6db908d530e3e82d","70ce1251b99d2c94","e622d2ec296a90fb"]]},{"id":"5cdb2dc10e1214bc","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 2","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1340,"wires":[["d6bda38ded21444c","6db908d530e3e82d","70ce1251b99d2c94","e622d2ec296a90fb"]]},{"id":"af503dd623cf5174","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { Temperature: msg.payload[0].averagetemp, Humidity: msg.payload[1].averagehum, Soil_Humidity: msg.payload[2].averagesoilhumid, pH: msg.payload[3].averagepH, setting: msg.payload[4], Status: msg.payload[5]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":1360,"wires":[["869ba5d46561139b"]]},{"id":"869ba5d46561139b","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.Status","propertyType":"msg","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":1230,"y":1360,"wires":[["0707989c177ac04f"]]},{"id":"0f3dd3433c5036bb","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"c52e7deb289caa8e","order":4,"width":10,"height":4,"gtype":"gage","title":"pH","label":"","format":"{{msg.payload.valuepH}}","min":0,"max":"14","colors":["#aad4ee","#6aa9fb","#005ca3"],"seg1":"","seg2":"","diff":false,"className":"","x":1010,"y":520,"wires":[]},{"id":"4d7c5941fec353ac","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"442a04fa8d8550a1","order":4,"width":10,"height":4,"gtype":"gage","title":"pH","label":"","format":"{{msg.payload.valuepH}}","min":0,"max":"14","colors":["#aad4ee","#6aa9fb","#005ca3"],"seg1":"","seg2":"","diff":false,"className":"","x":1010,"y":760,"wires":[]},{"id":"0a00a1b32882bd85","type":"function","z":"e2d0491f8f79674f","name":"Rolling Average pH","func":"var currentTime = new Date().getTime();\nif (!context.lastTime) {\n    context.lastTime = currentTime;\n    context.sum = msg.payload.value;\n    context.count = 1;\n}\nif (currentTime - context.lastTime > 30000) {\n    // calculate average for previous messages\n    msg.payload.averagepH = context.sum / context.count;\n    // start tracking average again\n    context.sum = msg.payload.value;\n    context.count = 1;\n    context.lastTime = currentTime;\n    if(msg.payload.averagepH < 2){\n        msg.payload.averagepH = 2;\n    }\n} else {\n    context.sum += msg.payload.value;\n    context.count += 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":440,"wires":[["414fb3023c6c1be2","40f79e3bab903ace","6ff5293ba93e73c4","82b7324daa9107bc"]]},{"id":"20ce827b6dbcee0d","type":"function","z":"e2d0491f8f79674f","name":"pH Validation","func":"if (!msg.payload.pH) {\n    msg.payload.pH = 0;\n}\nmsg.payload = {\n    value: msg.payload.pH,\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1930,"y":440,"wires":[["0a00a1b32882bd85"]]},{"id":"414fb3023c6c1be2","type":"function","z":"e2d0491f8f79674f","name":"averagepH Float Extract","func":"if (msg.payload.averagepH){\n    msg.payload.averagepH = Math.round(parseFloat(msg.payload.averagepH) * 10) / 10;\nreturn msg;\n}else{return 0;}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2750,"y":440,"wires":[["755136d04865d6c4","97609dd4d3d48907","55767e218733b054"]]},{"id":"755136d04865d6c4","type":"ui_gauge","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":5,"width":6,"height":4,"gtype":"gage","title":"pH","label":"","format":"{{msg.payload.averagepH}}","min":0,"max":"14","colors":["#f8dfaa","#fbab6a","#ff4747"],"seg1":"","seg2":"","diff":false,"className":"","x":2990,"y":420,"wires":[]},{"id":"6ef7fd2ebe1c5848","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 3","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"3","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1380,"wires":[["d6bda38ded21444c","6db908d530e3e82d","70ce1251b99d2c94","e622d2ec296a90fb"]]},{"id":"23def9c9a07d42ba","type":"comment","z":"e2d0491f8f79674f","name":"Automation Logic","info":"","x":180,"y":1960,"wires":[]},{"id":"5a2b48b2d1177990","type":"switch","z":"e2d0491f8f79674f","name":">= pH_Atas","property":"payload.pH","propertyType":"msg","rules":[{"t":"gte","v":"payload.setting.pH_Atas","vt":"msg"}],"checkall":"true","repair":false,"outputs":1,"x":390,"y":2040,"wires":[["fbc6013f42141a0f","282c1a64cb3485a2"]]},{"id":"8d6dd63974749783","type":"switch","z":"e2d0491f8f79674f","name":"<= pH_bawah","property":"payload.pH","propertyType":"msg","rules":[{"t":"lte","v":"payload.setting.pH_bawah","vt":"msg"}],"checkall":"true","repair":false,"outputs":1,"x":400,"y":2080,"wires":[["a0f3b27ade4b041b","282c1a64cb3485a2"]]},{"id":"fbc6013f42141a0f","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { jumlahair: msg.payload.setting.cairanatas, msg: \"Injecting \" + msg.payload.setting.cairanatas + \" ml because pH value is : \" + msg.payload.pH +\"\",time: Date.now() };\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":2040,"wires":[["1a67d36a5e8f5f3a","282c1a64cb3485a2","d74a8a85cc30a26a","4a2cdba23df0ed88"]]},{"id":"a0f3b27ade4b041b","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"//msg.payload = flow.autodata.setting.cairanbawah;\nmsg.payload = {\n    jumlahair: msg.payload.setting.cairanbawah, msg: \"Injecting \" + msg.payload.setting.cairanbawah + \" ml because pH value is : \" + msg.payload.pH + \"\", time: Date.now()};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":2080,"wires":[["1a67d36a5e8f5f3a","282c1a64cb3485a2","d74a8a85cc30a26a","4a2cdba23df0ed88"]]},{"id":"1a67d36a5e8f5f3a","type":"debug","z":"e2d0491f8f79674f","name":"Automation Logic Output Check","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":970,"y":2040,"wires":[]},{"id":"3bb4fd83fc470534","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":640,"y":2120,"wires":[[]]},{"id":"b941af4f7e80bfc4","type":"debug","z":"e2d0491f8f79674f","name":"flow.autostatus check","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"topic","targetType":"msg","statusVal":"","statusType":"auto","x":1120,"y":1480,"wires":[]},{"id":"801252b7fa64bbda","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"autostatus","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1660,"wires":[[]]},{"id":"1a1c7030e8ecd0a2","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"autostatus","payloadType":"flow","x":700,"y":1480,"wires":[["b941af4f7e80bfc4"]]},{"id":"c7cc344e405bf655","type":"function","z":"e2d0491f8f79674f","name":"Get element count","func":"if (msg.payload!==undefined) {\n    msg.payload = msg.payload[0].data[0].length;\n\n} else {\n    msg.payload=\"\";\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4030,"y":340,"wires":[["c2222bd463486fa6"]]},{"id":"c2222bd463486fa6","type":"ui_text","z":"e2d0491f8f79674f","group":"62db7c629df26146","order":15,"width":3,"height":1,"name":"","label":"Count","format":"{{msg.payload}}","layout":"row-spread","className":"","x":4250,"y":340,"wires":[]},{"id":"6e7c7a2c95bc5dde","type":"ui_text_input","z":"e2d0491f8f79674f","name":"FIle name","label":"","tooltip":"Save chart in this name","group":"62db7c629df26146","order":13,"width":4,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"filename","sendOnBlur":true,"className":"","topicType":"str","x":3600,"y":200,"wires":[["3bd3f2ebec2e408c"]]},{"id":"5f6e47ec6de0f943","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"62db7c629df26146","order":14,"width":4,"height":1,"passthru":false,"label":"Save Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"save","topicType":"str","x":3610,"y":240,"wires":[["3bd3f2ebec2e408c"]]},{"id":"3bd3f2ebec2e408c","type":"function","z":"e2d0491f8f79674f","name":"Prepare save","func":"// File name was changed, save it in the context for later\nif (msg.topic===\"filename\") {\n    context.set(\"filename\",msg.payload);\n}\n\n// Save button was pressed, pick up the filename from context and \n// pass it to the next function node\nif (msg.topic===\"save\") {\n    var filename = context.get(\"filename\");\n    if (filename!==undefined) {\n        msg.payload = context.get(\"filename\");\n        return [msg,{topic: \"Save chart\", payload:\"Chart will be saved on next update\"}];\n    } else {\n        return [null,{topic: \"Save chart\", payload:\"Specify filename first\"}];\n    }\n}\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3850,"y":220,"wires":[["e31ab4d9b64772a0"],["884eb3250efd4804"]]},{"id":"884eb3250efd4804","type":"ui_toast","z":"e2d0491f8f79674f","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":4290,"y":300,"wires":[]},{"id":"e31ab4d9b64772a0","type":"function","z":"e2d0491f8f79674f","name":"Trigger save","func":"// Message received from the previous function node to save the chart\n// saving the filename in the context which will trigger saving of the chart\n// during the next update\nif (msg.topic===\"save\") {\n    context.set(\"filename\",msg.payload);\n} else {\n    // check if we have a filename, and if we do, save the chart\n    // Pass the filename to msg.filename property for the file out node\n    // remove the filename from the context so it does not trigger save on the \n    // next update\n    var filename = context.get(\"filename\");\n    if (filename!==undefined) {\n        // This next if statement was added to only save the chart, when all 3 data is received (min, max, average)\n        if ((msg.payload[0].data[0].length===msg.payload[0].data[1].length)&&(msg.payload[0].data[1].length===msg.payload[0].data[2].length)) {\n            msg.filename = \"/home/pi/charts/value_\" + filename + \".dump\";\n            context.set(\"filename\",undefined);\n            return [msg,{topic: \"Save chart\", payload:\"Chart saved successfully\"}]\n        }    \n    }\n}\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4010,"y":300,"wires":[["7b312618c4a96ef7"],["884eb3250efd4804"]]},{"id":"7b312618c4a96ef7","type":"file","z":"e2d0491f8f79674f","name":"Chart dump","filename":"filename","filenameType":"msg","appendNewline":true,"createDir":false,"overwriteFile":"true","x":4270,"y":260,"wires":[["0134c78a83e84a24"]]},{"id":"0134c78a83e84a24","type":"link out","z":"e2d0491f8f79674f","name":"","mode":"link","links":["6a62be0a3fb4d122"],"x":4405,"y":260,"wires":[]},{"id":"7684361cabe1b6e0","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"601fe907e912562c","order":5,"width":30,"height":6,"label":"Saved Chart","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"500","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#d62727","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1610,"y":3340,"wires":[[]]},{"id":"b608131290332cd0","type":"inject","z":"e2d0491f8f79674f","name":"Startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":200,"y":3340,"wires":[["e992664a31f87ae8"]]},{"id":"2bfbaff5c3654df3","type":"file in","z":"e2d0491f8f79674f","name":"Load chart","filename":"filename","filenameType":"msg","format":"utf8","sendError":true,"allProps":false,"x":1290,"y":3340,"wires":[["16e6ee88032fb580"]]},{"id":"16e6ee88032fb580","type":"json","z":"e2d0491f8f79674f","name":"","property":"payload","action":"","pretty":false,"x":1450,"y":3340,"wires":[["7684361cabe1b6e0"]]},{"id":"cd4e417806bf036b","type":"ui_dropdown","z":"e2d0491f8f79674f","name":"","label":"","tooltip":"Select a saved log to be loaded","place":"Select saved log","group":"601fe907e912562c","order":2,"width":5,"height":1,"passthru":false,"multiple":false,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"dropdown","topicType":"str","className":"","x":860,"y":3340,"wires":[["7440a542817ab968","b32eb7da098589e8"]]},{"id":"84107fafff44b402","type":"function","z":"e2d0491f8f79674f","name":"Format filelist for dropdown","func":"msg.options = [];\nfor (var i=0; i<msg.payload.length; i++) {\n    const obj = {};\n    obj [msg.payload[i].substring(msg.payload[i].indexOf(\"/value_\")+7,msg.payload[i].length-5)]=msg.payload[i];\n    msg.options.push(obj);\n}\nmsg.payload={};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":3340,"wires":[["cd4e417806bf036b"]]},{"id":"7440a542817ab968","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":3340,"wires":[["2bfbaff5c3654df3"]]},{"id":"b32eb7da098589e8","type":"function","z":"e2d0491f8f79674f","name":"Save filename","func":"if (msg.topic===\"dropdown\") {\n    context.set(\"filename\",msg.payload);\n}\nif ((msg.topic===\"Delete log\")&&(msg.payload=\"Yes\")) {\n    if (context.get(\"filename\")!==undefined) {\n        msg.payload = \"\\\"\" + context.get(\"filename\") + \"\\\"\";\n        context.set(\"filename\",null);\n        return [msg,{topic: \"Delete log\", payload: \"Log is deleted\"}];\n    } else {\n        return [null,{topic: \"Delete log\", payload: \"Log needs to be selected first\"}];\n    }\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":3400,"wires":[["7497e21e7816577d"],["d44dbca342fd342c"]]},{"id":"d5c69667c17d7f05","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"601fe907e912562c","order":3,"width":3,"height":1,"passthru":false,"label":"Delete log","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"delete","topicType":"str","x":380,"y":3400,"wires":[["54dbf042aec551ab"]]},{"id":"d44dbca342fd342c","type":"ui_toast","z":"e2d0491f8f79674f","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1310,"y":3460,"wires":[]},{"id":"acabcf4843bf55cd","type":"ui_toast","z":"e2d0491f8f79674f","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"Yes","cancel":"No","raw":false,"className":"","topic":"","name":"","x":770,"y":3400,"wires":[["b32eb7da098589e8"]]},{"id":"54dbf042aec551ab","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Are you sure you want to delete the log?","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"Delete log","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":3400,"wires":[["acabcf4843bf55cd"]]},{"id":"7497e21e7816577d","type":"exec","z":"e2d0491f8f79674f","command":"sudo rm ","addpay":"payload","append":"","useSpawn":"false","timer":"","winHide":false,"oldrc":false,"name":"","x":1280,"y":3400,"wires":[["bc2d9bd496d01521"],[],[]]},{"id":"e992664a31f87ae8","type":"fs-file-lister","z":"e2d0491f8f79674f","name":"","start":"/home/pi/charts","pattern":"value_*.dump","folders":"","hidden":true,"lstype":"files","path":true,"single":true,"depth":0,"stat":false,"showWarnings":true,"x":380,"y":3340,"wires":[["84107fafff44b402"]]},{"id":"bc2d9bd496d01521","type":"link out","z":"e2d0491f8f79674f","name":"","mode":"link","links":["6a62be0a3fb4d122"],"x":1415,"y":3400,"wires":[]},{"id":"6a62be0a3fb4d122","type":"link in","z":"e2d0491f8f79674f","name":"Update list of saved logs","links":["0134c78a83e84a24","bc2d9bd496d01521"],"x":245,"y":3300,"wires":[["e992664a31f87ae8"]]},{"id":"f65e35f4aaf7da55","type":"comment","z":"e2d0491f8f79674f","name":"Manual Operation","info":"","x":190,"y":2140,"wires":[]},{"id":"a9d6dd94d6e40997","type":"ui_form","z":"e2d0491f8f79674f","name":"","label":"","group":"fb0aa8ebcb6c9901","order":1,"width":10,"height":1,"options":[{"label":"Amount of Solvent","value":"jumlahair","type":"number","required":true,"rows":null}],"formValue":{"jumlahair":""},"payload":"","submit":"submit","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":230,"y":2220,"wires":[["94efd88df47c0119","e1da1e7a74620c0b","955f1d92155a1149"]]},{"id":"5257d77cd50707ee","type":"mqtt out","z":"e2d0491f8f79674f","name":"","topic":"esp32/output","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"f02d30787e2b888d","x":290,"y":1020,"wires":[]},{"id":"2188769376a6281e","type":"comment","z":"e2d0491f8f79674f","name":"Warning Setting","info":"","x":180,"y":2280,"wires":[]},{"id":"dabc6480c8284c3e","type":"ui_form","z":"e2d0491f8f79674f","name":"","label":"Temperature Warning","group":"79af5a6d262b719f","order":10,"width":0,"height":0,"options":[{"label":"Temperature Lower Limit (0-50) °C","value":"tempbawah","type":"number","required":true,"rows":null},{"label":"Temperature Upper Limit (0-50) °C","value":"tempatas","type":"number","required":true,"rows":null}],"formValue":{"tempbawah":"","tempatas":""},"payload":"","submit":"submit","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":200,"y":2320,"wires":[["8a02b6b7f3e3274e"]]},{"id":"4ef3b043520e866a","type":"ui_form","z":"e2d0491f8f79674f","name":"","label":"Air Humidity Warning","group":"79af5a6d262b719f","order":11,"width":0,"height":0,"options":[{"label":"Air Humidity Lower Limit (0-100) %","value":"humidbawah","type":"number","required":true,"rows":null},{"label":"Air Humidity Upper Limit (0-100) %","value":"humidatas","type":"number","required":true,"rows":null}],"formValue":{"humidbawah":"","humidatas":""},"payload":"","submit":"submit","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":200,"y":2400,"wires":[["c084e08fa3160957"]]},{"id":"5a5ccaefbd9877a6","type":"ui_form","z":"e2d0491f8f79674f","name":"","label":"Soil Moisture Warning","group":"79af5a6d262b719f","order":12,"width":0,"height":0,"options":[{"label":"Soil Moisture Lower Limit (0-100) %","value":"soilbawah","type":"number","required":true,"rows":null},{"label":"Soil Moisture Upper Limit (0-100) %","value":"soilatas","type":"number","required":true,"rows":null}],"formValue":{"soilbawah":"","soilatas":""},"payload":"","submit":"submit","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":200,"y":2480,"wires":[["97c381109328cb34"]]},{"id":"8b0c552f20c93951","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":1,"width":0,"height":0,"name":"","label":"Give Warning If","format":"{{msg.payload}}","layout":"row-left","className":"","x":420,"y":2360,"wires":[]},{"id":"3ded0a9b6151521e","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":3,"width":5,"height":1,"name":"","label":"Temperature >","format":"{{msg.payload.tempatas}}","layout":"row-left","className":"","x":920,"y":2320,"wires":[]},{"id":"f464f53a6c9069b4","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":2,"width":5,"height":1,"name":"","label":"Temperature <","format":"{{msg.payload.tempbawah}}","layout":"row-left","className":"","x":680,"y":2340,"wires":[]},{"id":"98e576548540c0d5","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":5,"width":5,"height":1,"name":"","label":"Air Humidity >","format":"{{msg.payload.humidatas}}","layout":"row-left","className":"","x":920,"y":2400,"wires":[]},{"id":"8306df51256849d4","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":4,"width":5,"height":1,"name":"","label":"Air Humidity <","format":"{{msg.payload.humidbawah}}","layout":"row-left","className":"","x":680,"y":2420,"wires":[]},{"id":"c932edcd3b795b8c","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":7,"width":5,"height":1,"name":"","label":"Soil Moisture >","format":"{{msg.payload.soilatas}}","layout":"row-left","className":"","x":920,"y":2480,"wires":[]},{"id":"c7b6a5d58a8c9dae","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":6,"width":5,"height":1,"name":"","label":"Soil Moisture <","format":"{{msg.payload.soilbawah}}","layout":"row-left","className":"","x":680,"y":2500,"wires":[]},{"id":"535e10d536d0fb13","type":"comment","z":"e2d0491f8f79674f","name":"Warning Logic","info":"","x":290,"y":2660,"wires":[]},{"id":"44307376b5705338","type":"switch","z":"e2d0491f8f79674f","name":"Temperature","property":"payload.Temperature","propertyType":"msg","rules":[{"t":"gte","v":"payload.batastemp.tempatas","vt":"msg"},{"t":"lte","v":"payload.batastemp.tempbawah","vt":"msg"},{"t":"btwn","v":"payload.batastemp.tempbawah","vt":"msg","v2":"payload.batastemp.tempatas","v2t":"msg"}],"checkall":"false","repair":false,"outputs":3,"x":1230,"y":2760,"wires":[["72ef4cfa2b83c924"],["4bf806a73bf8b908"],["58b02c55189cac65"]]},{"id":"6d5998d1db944ec0","type":"switch","z":"e2d0491f8f79674f","name":"Humiditas","property":"payload.Humidity","propertyType":"msg","rules":[{"t":"gte","v":"payload.batashumid.humidatas","vt":"msg"},{"t":"lte","v":"payload.batashumid.humidbawah","vt":"msg"},{"t":"btwn","v":"payload.batashumid.humidbawah","vt":"msg","v2":"payload.batashumid.humidatas","v2t":"msg"}],"checkall":"false","repair":false,"outputs":3,"x":1220,"y":2880,"wires":[["7f5f9ed782cf6898"],["6cfa552ac4319821"],["655503b87eadbab3"]]},{"id":"221a6a6a5eb7d66c","type":"switch","z":"e2d0491f8f79674f","name":"Soil Moisture","property":"payload.Soil_Humidity","propertyType":"msg","rules":[{"t":"gte","v":"payload.batassoil.soilatas","vt":"msg"},{"t":"lte","v":"payload.batassoil.soilbawah","vt":"msg"},{"t":"btwn","v":"payload.batassoil.soilbawah","vt":"msg","v2":"payload.batassoil.soilatas","v2t":"msg"}],"checkall":"false","repair":false,"outputs":3,"x":1230,"y":3000,"wires":[["17d69cdd765648f0"],["03fe663c759d2aae"],["ae088c21fccd074e"]]},{"id":"cf4ac2ac0eab1941","type":"ui_toast","z":"e2d0491f8f79674f","position":"top right","displayTime":"5","highlight":"Red","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"Warning !!","name":"","x":4150,"y":3080,"wires":[]},{"id":"07310e392843c76a","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload.warningtemp","pt":"msg","to":"\"Temperature right now is : \"  & msg.payload.tempres.temperature & \"°C \" &msg.payload.tempres.kondisi& \" set parameter\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":2760,"wires":[["3c35781376bdc698"]]},{"id":"72ef4cfa2b83c924","type":"function","z":"e2d0491f8f79674f","name":"Diatas","func":"msg.payload.tempres = {temperature : msg.payload.Temperature, kondisi : \"above\", status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1390,"y":2720,"wires":[["07310e392843c76a"]]},{"id":"4bf806a73bf8b908","type":"function","z":"e2d0491f8f79674f","name":"Dibawah","func":"msg.payload.tempres = {temperature : msg.payload.Temperature, kondisi : \"below\", status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":2760,"wires":[["07310e392843c76a"]]},{"id":"14c2a0acee316032","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":830,"y":2760,"wires":[["2900a4977f9581d4"]]},{"id":"93648bf6a7032b44","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":2760,"wires":[["14c2a0acee316032"]]},{"id":"425b5c6d61e9e203","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2780,"wires":[["93648bf6a7032b44"]]},{"id":"e494d4b95e493a13","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2740,"wires":[["93648bf6a7032b44"]]},{"id":"2900a4977f9581d4","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { Temperature: msg.payload[0].averagetemp, batastemp: msg.payload[1]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":2760,"wires":[["44307376b5705338"]]},{"id":"acc38039b7819333","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"tempset","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":2300,"wires":[[]]},{"id":"ddf64b39f8834ff1","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"tempset","payloadType":"flow","x":260,"y":2780,"wires":[["425b5c6d61e9e203"]]},{"id":"3ddb2886539cbed0","type":"node-red-contrib-whatsapp-cmb-send-message","z":"e2d0491f8f79674f","name":"","account":"a78311fe38ed89d0","text":"text","inputtypemessage":"msg","rejectssl":false,"x":2160,"y":2300,"wires":[["80c790eccb4662ed"]]},{"id":"e863b42537c79630","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"text","v":"Whatsapp message working","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":1990,"y":2300,"wires":[["3ddb2886539cbed0"]]},{"id":"80c790eccb4662ed","type":"debug","z":"e2d0491f8f79674f","name":"Whatsapp Send Prototype","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2390,"y":2300,"wires":[]},{"id":"8a5b507f2c59bc67","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload.warninghum","pt":"msg","to":"\"Air Humidity right now is : \"  & msg.payload.humres.humidity & \" % \" &msg.payload.humres.kondisi& \" set parameter\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":2880,"wires":[["a3e82eb0b6708baf"]]},{"id":"7f5f9ed782cf6898","type":"function","z":"e2d0491f8f79674f","name":"Diatas","func":"msg.payload.humres = {humidity : msg.payload.Humidity, kondisi : \"above\", status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1390,"y":2840,"wires":[["8a5b507f2c59bc67"]]},{"id":"6cfa552ac4319821","type":"function","z":"e2d0491f8f79674f","name":"Dibawah","func":"msg.payload.humres = {humidity : msg.payload.Humidity, kondisi : \"below\", status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":2880,"wires":[["8a5b507f2c59bc67"]]},{"id":"6591b2458a2ef0da","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":830,"y":2880,"wires":[["eeeeb38bb51ff40f"]]},{"id":"28b330aada649c57","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":2880,"wires":[["6591b2458a2ef0da"]]},{"id":"9fbb84407c779955","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2900,"wires":[["28b330aada649c57"]]},{"id":"0c7995fb8834d480","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2860,"wires":[["28b330aada649c57"]]},{"id":"eeeeb38bb51ff40f","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { Humidity : msg.payload[0].averagehum, batashumid: msg.payload[1]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":2880,"wires":[["6d5998d1db944ec0"]]},{"id":"816a344c82170d46","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload.warningsoil","pt":"msg","to":"\"Soil Moisture right now is : \"  & msg.payload.soilres.soil & \" % \" &msg.payload.soilres.kondisi& \" set parameter\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":3000,"wires":[["3893b55603b3cfef"]]},{"id":"17d69cdd765648f0","type":"function","z":"e2d0491f8f79674f","name":"Diatas","func":"msg.payload.soilres = {soil : msg.payload.Soil_Humidity, kondisi : \"above\",status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1390,"y":2960,"wires":[["816a344c82170d46"]]},{"id":"03fe663c759d2aae","type":"function","z":"e2d0491f8f79674f","name":"Dibawah","func":"msg.payload.soilres = { soil: msg.payload.Soil_Humidity, kondisi : \"below\", status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":3000,"wires":[["816a344c82170d46"]]},{"id":"8c2d76c557ab6bb8","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":830,"y":3000,"wires":[["20589eb2640aa19a"]]},{"id":"f197e6591e6ca556","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":3000,"wires":[["8c2d76c557ab6bb8"]]},{"id":"2fe87a52b6fc0722","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":3020,"wires":[["f197e6591e6ca556"]]},{"id":"bc8f4fa74b637e58","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":2980,"wires":[["f197e6591e6ca556"]]},{"id":"20589eb2640aa19a","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { Soil_Humidity: msg.payload[0].averagesoilhumid, batassoil: msg.payload[1]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":3000,"wires":[["221a6a6a5eb7d66c"]]},{"id":"8f2da3df4329853f","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"humidset","payloadType":"flow","x":260,"y":2900,"wires":[["9fbb84407c779955"]]},{"id":"491c58e060511f1c","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"soilset","payloadType":"flow","x":250,"y":3020,"wires":[["2fe87a52b6fc0722"]]},{"id":"7e5fa9294a7f2348","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"humidset","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":2380,"wires":[[]]},{"id":"3a72c778d7071737","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"soilset","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":2460,"wires":[[]]},{"id":"dccdecae760a531c","type":"inject","z":"e2d0491f8f79674f","name":"30","props":[{"p":"payload.averagetemp","v":"30","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2740,"wires":[["e494d4b95e493a13"]]},{"id":"15cf48cde4fd48bd","type":"inject","z":"e2d0491f8f79674f","name":"20","props":[{"p":"payload.averagehum","v":"20","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2820,"wires":[["0c7995fb8834d480"]]},{"id":"b3ae6cd14fdad4fb","type":"inject","z":"e2d0491f8f79674f","name":"80","props":[{"p":"payload.averagesoilhumid","v":"80","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":3020,"wires":[["bc8f4fa74b637e58"]]},{"id":"9a38963ceaca522a","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":2950,"y":2940,"wires":[["840728b5a87fe5e7"]]},{"id":"301439d744a2bd78","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"msg.count","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":2940,"wires":[["9a38963ceaca522a"]]},{"id":"0ceb064b73ea68d8","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2540,"y":2880,"wires":[["301439d744a2bd78"]]},{"id":"41c30f3029144f0f","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2540,"y":2760,"wires":[["301439d744a2bd78"]]},{"id":"7c881cc921b8b68a","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 2","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2540,"y":3000,"wires":[["301439d744a2bd78"]]},{"id":"3c35781376bdc698","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.tempres.status","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1870,"y":2760,"wires":[["eddd8ca2539bed48"]]},{"id":"a3e82eb0b6708baf","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.humres.status","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1870,"y":2880,"wires":[["930764f4f505130c"]]},{"id":"3893b55603b3cfef","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.soilres.status","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1870,"y":3000,"wires":[["afe77189bd5b1a59"]]},{"id":"58b02c55189cac65","type":"function","z":"e2d0491f8f79674f","name":"Normal","func":"msg.payload.tempres = {temperature : msg.payload.Temperature, status : false}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":2800,"wires":[["07310e392843c76a"]]},{"id":"655503b87eadbab3","type":"function","z":"e2d0491f8f79674f","name":"Normal","func":"msg.payload.humres = { humidity: msg.payload.Humidity, status : false}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":2920,"wires":[["8a5b507f2c59bc67"]]},{"id":"ae088c21fccd074e","type":"function","z":"e2d0491f8f79674f","name":"Normal","func":"msg.payload.soilres = { soil: msg.payload.Soil_Humidity, status : false}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":3040,"wires":[["816a344c82170d46"]]},{"id":"f367b743a37e5138","type":"inject","z":"e2d0491f8f79674f","name":"tempres true","props":[{"p":"payload.warningtemp.status","v":"true","vt":"bool"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":1710,"y":2720,"wires":[["3c35781376bdc698"]]},{"id":"eefa733542b09155","type":"inject","z":"e2d0491f8f79674f","name":"humres true","props":[{"p":"payload.humres.warninghum","v":"true","vt":"bool"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":1690,"y":2840,"wires":[["a3e82eb0b6708baf"]]},{"id":"47cd88b883673a81","type":"delay","z":"e2d0491f8f79674f","name":"","pauseType":"delay","timeout":"400","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2470,"y":2680,"wires":[["b63041e81efe9bcd"]]},{"id":"9cf1c93c9580acd8","type":"timed-counter","z":"e2d0491f8f79674f","name":"","timelimit":"4","timeunit":"1000","withhold":true,"fixedtimeout":false,"pertopic":false,"countlimit":"3","x":2260,"y":2680,"wires":[["1cd5a1756fbaf637","47cd88b883673a81"]]},{"id":"95a9c7f2197291ac","type":"delay","z":"e2d0491f8f79674f","name":"","pauseType":"delay","timeout":"6","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2240,"y":3000,"wires":[["8cd17c2e2d5fd97f"]]},{"id":"00c194935cb745c8","type":"delay","z":"e2d0491f8f79674f","name":"","pauseType":"delay","timeout":"6","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2240,"y":2880,"wires":[["3cff70c09b1aec43"]]},{"id":"b63041e81efe9bcd","type":"switch","z":"e2d0491f8f79674f","name":"","property":"msg.count","propertyType":"flow","rules":[{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":2630,"y":2680,"wires":[["30d93d89de2dd4bf"]]},{"id":"ae8695844d344644","type":"switch","z":"e2d0491f8f79674f","name":"","property":"msg.count","propertyType":"flow","rules":[{"t":"neq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2370,"y":2760,"wires":[["41c30f3029144f0f"]]},{"id":"810afa2c8bec1085","type":"delay","z":"e2d0491f8f79674f","name":"","pauseType":"delay","timeout":"6","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2240,"y":2760,"wires":[["ae8695844d344644"]]},{"id":"1cd5a1756fbaf637","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"msg.count","pt":"flow","to":"count","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2490,"y":2640,"wires":[[]]},{"id":"3cff70c09b1aec43","type":"switch","z":"e2d0491f8f79674f","name":"","property":"msg.count","propertyType":"flow","rules":[{"t":"neq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2370,"y":2880,"wires":[["0ceb064b73ea68d8"]]},{"id":"8cd17c2e2d5fd97f","type":"switch","z":"e2d0491f8f79674f","name":"","property":"msg.count","propertyType":"flow","rules":[{"t":"neq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2370,"y":3000,"wires":[["7c881cc921b8b68a"]]},{"id":"5e2fe28a4c7027c6","type":"inject","z":"e2d0491f8f79674f","name":"soilrestrue","props":[{"p":"payload.soilres.warningsoil","v":"true","vt":"bool"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":1700,"y":2960,"wires":[["3893b55603b3cfef"]]},{"id":"840728b5a87fe5e7","type":"function","z":"e2d0491f8f79674f","name":"Remove undefined value","func":"msg.payload = msg.payload.filter(function (element) {\n    return element !== undefined;\n});\nmsg.payload = msg.payload.join(\" and \");\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3150,"y":2940,"wires":[["30d93d89de2dd4bf"]]},{"id":"930764f4f505130c","type":"function","z":"e2d0491f8f79674f","name":"warninghum extract","func":"msg.payload = msg.payload.warninghum\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2050,"y":2880,"wires":[["00c194935cb745c8","9cf1c93c9580acd8"]]},{"id":"afe77189bd5b1a59","type":"function","z":"e2d0491f8f79674f","name":"warningsoil extract","func":"msg.payload = msg.payload.warningsoil;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2050,"y":3000,"wires":[["95a9c7f2197291ac","9cf1c93c9580acd8"]]},{"id":"eddd8ca2539bed48","type":"function","z":"e2d0491f8f79674f","name":"warningtemp extract","func":"msg.payload = msg.payload.warningtemp;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2040,"y":2760,"wires":[["810afa2c8bec1085","9cf1c93c9580acd8"]]},{"id":"30d93d89de2dd4bf","type":"trigger","z":"e2d0491f8f79674f","name":"","op1":"","op2":"","op1type":"pay","op2type":"nul","duration":"15","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":3370,"y":2940,"wires":[["a87c8e8fa5baf5e0","c415248190aef649","08b3035cbbcd3b49","f18194065d5ef2f8"]]},{"id":"a87c8e8fa5baf5e0","type":"debug","z":"e2d0491f8f79674f","name":"Warning Notification Check","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3880,"y":2880,"wires":[]},{"id":"b5bda5859e49e2d6","type":"comment","z":"e2d0491f8f79674f","name":"CONNECT THIS NODE TO COMPLETE PROCESS","info":"","x":610,"y":1220,"wires":[]},{"id":"b6e3adfd0a2fe864","type":"link in","z":"e2d0491f8f79674f","name":"link in 1","links":["30a8d330be816071"],"x":245,"y":1260,"wires":[["e3510d0237bddd82"]]},{"id":"2f701289a023c2fd","type":"link in","z":"e2d0491f8f79674f","name":"link in 2","links":["ce7b807acd540a6e"],"x":245,"y":1300,"wires":[["a783c28f4b214a78"]]},{"id":"e5edbca0b842cd52","type":"link in","z":"e2d0491f8f79674f","name":"link in 3","links":["c8b14bc46039a64a"],"x":245,"y":1340,"wires":[["5cdb2dc10e1214bc"]]},{"id":"f5de0fb24d4485d0","type":"link in","z":"e2d0491f8f79674f","name":"link in 4","links":["97609dd4d3d48907"],"x":245,"y":1380,"wires":[["6ef7fd2ebe1c5848"]]},{"id":"30a8d330be816071","type":"link out","z":"e2d0491f8f79674f","name":"link out 1","mode":"link","links":["b6e3adfd0a2fe864","b75a12a9ef2d5a28","39674cd4a5fb15d7"],"x":2965,"y":300,"wires":[]},{"id":"ce7b807acd540a6e","type":"link out","z":"e2d0491f8f79674f","name":"link out 2","mode":"link","links":["2f701289a023c2fd","2db9a612dd4b7905","fcaeeb033097bc03","4255c4b7022743df"],"x":2965,"y":220,"wires":[]},{"id":"c8b14bc46039a64a","type":"link out","z":"e2d0491f8f79674f","name":"link out 3","mode":"link","links":["e5edbca0b842cd52","d960e5c3f84ba593","c5f282fe14d9874f","c3fb4e1e6255519a"],"x":2965,"y":380,"wires":[]},{"id":"97609dd4d3d48907","type":"link out","z":"e2d0491f8f79674f","name":"link out 4","mode":"link","links":["f5de0fb24d4485d0","a4a469a9b2a27442","db5b03cdbae046a0"],"x":2965,"y":460,"wires":[]},{"id":"c587fcc4d646f1d8","type":"comment","z":"e2d0491f8f79674f","name":"Average value chart function","info":"","x":3640,"y":140,"wires":[]},{"id":"0707989c177ac04f","type":"link out","z":"e2d0491f8f79674f","name":"link out 5","mode":"link","links":["041a420e53c8af75"],"x":1405,"y":1360,"wires":[]},{"id":"041a420e53c8af75","type":"link in","z":"e2d0491f8f79674f","name":"link in 5","links":["0707989c177ac04f"],"x":195,"y":2060,"wires":[["5a2b48b2d1177990","8d6dd63974749783","8e2c45e2e8790a62"]]},{"id":"40c869f21f36402b","type":"link in","z":"e2d0491f8f79674f","name":"link in 6","links":["248868619b3a025e"],"x":125,"y":2220,"wires":[["a9d6dd94d6e40997"]]},{"id":"248868619b3a025e","type":"link out","z":"e2d0491f8f79674f","name":"link out 6","mode":"link","links":["40c869f21f36402b"],"x":695,"y":1840,"wires":[]},{"id":"29739a4e58d2c3f8","type":"comment","z":"e2d0491f8f79674f","name":"View Save Chart","info":"","x":200,"y":3240,"wires":[]},{"id":"141c19ed836c36dd","type":"comment","z":"e2d0491f8f79674f","name":"Daftar Isi","info":"# **Daftar Isi**\n## 1. Board Info\n## 2. Average Value\n## 3. Data Join\n## 4. Automation Setting\n## 5. Automation Logic\n## 6. Manual Operation\n## 7. Warning Setting\n## 8. Warning Logic\n## 9. View Save Chart","x":180,"y":80,"wires":[]},{"id":"e8e2619fa4b6e587","type":"function","z":"e2d0491f8f79674f","name":"Sensordata ph","func":"var global_name = \"sensordataph\";   // Name of the global variable\nvar minutelysize = 60;\nvar hourlysize = 24;            // Number of hourly stat to collect (24 for the last 24 hours)\nvar dailysize = 14;             // Number of daily stat to collect\nvar weeklysize = 12;             // Number of weekly stat to collect\nvar monthlysize = 12;\nvar current = new Date();\nvar summinute = 0;\nvar sumhour = 0;\nvar sumdaily = 0;\nvar summweek = 0;\nvar summmonth = 0;\n\n\n\nvar mystat = global.get(global_name);\nif (mystat === undefined) {\n    mystat = {};\n}\n\n// If the message is coming from sensor, save the current value\nif (msg.topic.includes(\"sensor\")) {\n    context.set(\"DATAPH\", msg.payload.averagepH);\n    msg.topic = \"reading\";\n}\n\n// Do not process stats until we have a valid reading\nif (context.get(\"DATAPH\") !== undefined) {\n\n    // Update the minutely stats\n    if (msg.topic === \"minutely\") {\n        msg.topic = \"minutely\";\n        // First update the historical readings\n        if (mystat.minutelyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.minutelyvalues = [];\n            mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATAPH\") });\n        } else {\n            if (mystat.minutelyvalues.length < minutelysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATAPH\") });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.minutelyvalues.length; i++) {\n                    mystat.minutelyvalues[i - 1] = mystat.minutelyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.minutelyvalues[minutelysize - 1] = { epoch: current.getTime(), reading: context.get(\"DATAPH\") };\n            }\n        }\n    }\n\n    // Update the hourly stats\n    if (msg.topic === \"hourly\") {\n        msg.topic = \"hourly\";\n        for (i = 0; i < minutelysize; i++) {\n            summinute += mystat.minutelyvalues[i].reading;\n        }\n        var averageminute = summinute / minutelysize;\n        // First update the historical readings\n        if (mystat.hourlyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.hourlyvalues = [];\n            mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute });\n        } else {\n            if (mystat.hourlyvalues.length < hourlysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.hourlyvalues.length; i++) {\n                    mystat.hourlyvalues[i - 1] = mystat.hourlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.hourlyvalues[hourlysize - 1] = { epoch: current.getTime(), reading: averageminute };\n            }\n        }\n\n    }\n\n    // Update the daily stats\n    if (msg.topic === \"daily\") {\n        msg.topic = \"daily\";\n        for (i = 0; i < hourlysize; i++) {\n            sumhour += mystat.hourlyvalues[i].reading;\n        }\n        var averagehour = sumhour / hourlysize;\n        // First update the historical readings\n        if (mystat.dailyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.dailyvalues = [];\n            mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour });\n        } else {\n            if (mystat.dailyvalues.length < dailysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.dailyvalues.length; i++) {\n                    mystat.dailyvalues[i - 1] = mystat.dailyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.dailyvalues[dailysize - 1] = { epoch: current.getTime(), reading: averagehour };\n            }\n        }\n    }\n\n    // Update the weekly stats\n    if (msg.topic === \"weekly\") {\n        msg.topic = \"weekly\";\n        for (i = 0; i < dailysize; i++) {\n            sumdaily += mystat.dailyvalues[i].reading;\n        }\n        var averagedaily = sumdaily / dailysize;\n        // First update the historical readings\n        if (mystat.weeklyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.weeklyvalues = [];\n            mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily });\n        } else {\n            if (mystat.weeklyvalues.length < weeklysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.weeklyvalues.length; i++) {\n                    mystat.weeklyvalues[i - 1] = mystat.weeklyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.weeklyvalues[weeklysize - 1] = { epoch: current.getTime(), reading: averagedaily };\n            }\n        }\n    }\n\n    // Update the monthly stats\n    if (msg.topic === \"monthly\") {\n        msg.topic = \"monthly\";\n        for (i = 0; i < weeklysize; i++) {\n            summweek += mystat.weeklyvalues[i].reading;\n        }\n        var averageweekly = summweek / weeklysize;\n        // First update the historical readings\n        if (mystat.monthlyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.monthlyvalues = [];\n            mystat.monthlyvalues.push({ epoch: current.getTime(), reading: averageweekly });\n        } else {\n            if (mystat.monthlyvalues.length < monthlysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.monthlyvalues.push({ epoch: current.getTime(), reading: averageweekly });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.monthlyvalues.length; i++) {\n                    mystat.monthlyvalues[i - 1] = mystat.monthlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.monthlyvalues[monthlysize - 1] = { epoch: current.getTime(), reading: averageweekly };\n            }\n        }\n    }\n\n    if (mystat.monthlyvalues !== undefined) {\n        if (mystat.monthlyvalues.length > 0) {\n            mystat.thismonth = Math.round((mystat.monthlyvalues[mystat.monthlyvalues.length - 1].reading) * 10) / 10;\n            if (mystat.thismonth < 0) {\n                mystat.thismonth = 0.0;\n            }\n        } else {\n            mystat.thismonth = 0.0;\n        }\n    }\n\n    // This week rainfall calculation\n    if (mystat.weeklyvalues !== undefined) {\n        if (mystat.weeklyvalues.length > 0) {\n            mystat.thisweek = Math.round((mystat.weeklyvalues[mystat.weeklyvalues.length - 1].reading) * 10) / 10;\n            if (mystat.thisweek < 0) {\n                mystat.thisweek = 0.0;\n            }\n        } else {\n            mystat.thisweek = 0.0;\n        }\n    }\n    // Today rainfall calculation\n    if (mystat.dailyvalues !== undefined) {\n        if (mystat.dailyvalues.length > 0) {\n            mystat.today = mystat.dailyvalues[mystat.dailyvalues.length - 1].reading;\n            mystat.today = Math.round((mystat.today) * 10) / 10;\n            if (mystat.today < 0) {\n                mystat.today = 0.0;\n            }\n        } else {\n            mystat.today = 0.0;\n        }\n    }\n    // This hour rainfall calculation\n    if (mystat.hourlyvalues !== undefined) {\n        if (mystat.hourlyvalues.length > 0) {\n            mystat.thishour = mystat.hourlyvalues[mystat.hourlyvalues.length - 1].reading;\n            mystat.thishour = Math.round((mystat.thishour) * 10) / 10;\n            if (mystat.thishour < 0) {\n                mystat.thishour = 0.0;\n            }\n        } else {\n            mystat.thishour = 0.0;\n        }\n    }\n\n    // Store the updates\n    global.set(global_name, mystat);\n    msg.payload = mystat;\n    node.status({ fill: \"blue\", shape: \"ring\", text: msg.topic + \" performed\" });\n    return msg;\n} else {\n    node.status({ fill: \"red\", shape: \"ring\", text: \"No reading\" });\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2240,"y":1100,"wires":[["6651ae9a4bae7342"]]},{"id":"67da260229d04586","type":"function","z":"e2d0491f8f79674f","name":"Sensordata temp","func":"var global_name = \"sensordatatemp\";   // Name of the global variable\nvar minutelysize = 60;\nvar hourlysize = 24;            // Number of hourly stat to collect (24 for the last 24 hours)\nvar dailysize = 14;             // Number of daily stat to collect\nvar weeklysize = 12;             // Number of weekly stat to collect\nvar monthlysize = 12;\nvar current = new Date();\nvar summinute = 0;\nvar sumhour = 0;\nvar sumdaily = 0;\nvar summweek = 0;\nvar summmonth = 0;\n\n\n\nvar mystat = global.get(global_name);\nif (mystat === undefined) {\n    mystat = {};\n}\n\n// If the message is coming from sensor, save the current value\nif (msg.topic.includes(\"sensor\")) {\n    context.set(\"DATATEMP\", msg.payload.averagetemp);\n    msg.topic = \"reading\";\n}\n\n// Do not process stats until we have a valid reading\nif (context.get(\"DATATEMP\") !== undefined) {\n\n    // Update the minutely stats\n    if (msg.topic === \"minutely\") {\n        msg.topic = \"minutely\";\n        // First update the historical readings\n        if (mystat.minutelyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.minutelyvalues = [];\n            mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATATEMP\") });\n        } else {\n            if (mystat.minutelyvalues.length < minutelysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATATEMP\") });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.minutelyvalues.length; i++) {\n                    mystat.minutelyvalues[i - 1] = mystat.minutelyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.minutelyvalues[minutelysize - 1] = { epoch: current.getTime(), reading: context.get(\"DATATEMP\") };\n            }\n        }\n    }\n\n    // Update the hourly stats\n    if (msg.topic === \"hourly\") {\n        msg.topic = \"hourly\";\n        for (i = 0; i < minutelysize; i++) {\n            summinute += mystat.minutelyvalues[i].reading;\n        }\n        var averageminute = summinute / minutelysize;\n        // First update the historical readings\n        if (mystat.hourlyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.hourlyvalues = [];\n            mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute });\n        } else {\n            if (mystat.hourlyvalues.length < hourlysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.hourlyvalues.length; i++) {\n                    mystat.hourlyvalues[i - 1] = mystat.hourlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.hourlyvalues[hourlysize - 1] = { epoch: current.getTime(), reading: averageminute };\n            }\n        }\n\n    }\n\n    // Update the daily stats\n    if (msg.topic === \"daily\") {\n        msg.topic = \"daily\";\n        for (i = 0; i < hourlysize; i++) {\n            sumhour += mystat.hourlyvalues[i].reading;\n        }\n        var averagehour = sumhour / hourlysize;\n        // First update the historical readings\n        if (mystat.dailyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.dailyvalues = [];\n            mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour });\n        } else {\n            if (mystat.dailyvalues.length < dailysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.dailyvalues.length; i++) {\n                    mystat.dailyvalues[i - 1] = mystat.dailyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.dailyvalues[dailysize - 1] = { epoch: current.getTime(), reading: averagehour };\n            }\n        }\n    }\n\n    // Update the weekly stats\n    if (msg.topic === \"weekly\") {\n        msg.topic = \"weekly\";\n        for (i = 0; i < dailysize; i++) {\n            sumdaily += mystat.dailyvalues[i].reading;\n        }\n        var averagedaily = sumdaily / dailysize;\n        // First update the historical readings\n        if (mystat.weeklyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.weeklyvalues = [];\n            mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily });\n        } else {\n            if (mystat.weeklyvalues.length < weeklysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.weeklyvalues.length; i++) {\n                    mystat.weeklyvalues[i - 1] = mystat.weeklyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.weeklyvalues[weeklysize - 1] = { epoch: current.getTime(), reading: averagedaily };\n            }\n        }\n    }\n\n    // Update the monthly stats\n    if (msg.topic === \"monthly\") {\n        msg.topic = \"monthly\";\n        for (i = 0; i < weeklysize; i++) {\n            summweek += mystat.weeklyvalues[i].reading;\n        }\n        var averageweekly = summweek / weeklysize;\n        // First update the historical readings\n        if (mystat.monthlyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.monthlyvalues = [];\n            mystat.monthlyvalues.push({ epoch: current.getTime(), reading: averageweekly });\n        } else {\n            if (mystat.monthlyvalues.length < monthlysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.monthlyvalues.push({ epoch: current.getTime(), reading: averageweekly });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.monthlyvalues.length; i++) {\n                    mystat.monthlyvalues[i - 1] = mystat.monthlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.monthlyvalues[monthlysize - 1] = { epoch: current.getTime(), reading: averageweekly };\n            }\n        }\n    }\n\n    if (mystat.monthlyvalues !== undefined) {\n        if (mystat.monthlyvalues.length > 0) {\n            mystat.thismonth = Math.round((mystat.monthlyvalues[mystat.monthlyvalues.length - 1].reading) * 10) / 10;\n            if (mystat.thismonth < 0) {\n                mystat.thismonth = 0.0;\n            }\n        } else {\n            mystat.thismonth = 0.0;\n        }\n    }\n\n    // This week rainfall calculation\n    if (mystat.weeklyvalues !== undefined) {\n        if (mystat.weeklyvalues.length > 0) {\n            mystat.thisweek = Math.round((mystat.weeklyvalues[mystat.weeklyvalues.length - 1].reading) * 10) / 10;\n            if (mystat.thisweek < 0) {\n                mystat.thisweek = 0.0;\n            }\n        } else {\n            mystat.thisweek = 0.0;\n        }\n    }\n    // Today rainfall calculation\n    if (mystat.dailyvalues !== undefined) {\n        if (mystat.dailyvalues.length > 0) {\n            mystat.today = mystat.dailyvalues[mystat.dailyvalues.length - 1].reading;\n            mystat.today = Math.round((mystat.today) * 10) / 10;\n            if (mystat.today < 0) {\n                mystat.today = 0.0;\n            }\n        } else {\n            mystat.today = 0.0;\n        }\n    }\n    // This hour rainfall calculation\n    if (mystat.hourlyvalues !== undefined) {\n        if (mystat.hourlyvalues.length > 0) {\n            mystat.thishour = mystat.hourlyvalues[mystat.hourlyvalues.length - 1].reading;\n            mystat.thishour = Math.round((mystat.thishour) * 10) / 10;\n            if (mystat.thishour < 0) {\n                mystat.thishour = 0.0;\n            }\n        } else {\n            mystat.thishour = 0.0;\n        }\n    }\n\n    // Store the updates\n    global.set(global_name, mystat);\n    msg.payload = mystat;\n    node.status({ fill: \"blue\", shape: \"ring\", text: msg.topic + \" performed\" });\n    return msg;\n} else {\n    node.status({ fill: \"red\", shape: \"ring\", text: \"No reading\" });\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":940,"wires":[["76ca524f662ea817"]]},{"id":"944bbc22e72e0945","type":"function","z":"e2d0491f8f79674f","name":"Sensordata humid","func":"var global_name = \"sensordatahumid\";   // Name of the global variable\nvar minutelysize = 60;\nvar hourlysize = 24;            // Number of hourly stat to collect (24 for the last 24 hours)\nvar dailysize = 14;             // Number of daily stat to collect\nvar weeklysize = 12;             // Number of weekly stat to collect\nvar current = new Date();\nvar summinute = 0;\nvar sumhour = 0;\nvar sumdaily = 0;\nvar summweek = 0;\n\nvar mystat = global.get(global_name);\nif (mystat===undefined) {\n    mystat = {};\n}\n\n// If the message is coming from sensor, save the current value\nif (msg.topic.includes(\"sensor\")) {\n    context.set(\"DATAHUMID\", msg.payload.value.averagehum);\n    msg.topic=\"reading\";\n}\n\n// Do not process stats until we have a valid reading\nif (context.get(\"DATAHUMID\")!==undefined) {\n\n    // Update the minutely stats\n    if (msg.topic === \"minutely\") {\n        msg.topic = \"minutely\";\n        // First update the historical readings\n        if (mystat.minutelyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.minutelyvalues = [];\n            mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATAHUMID\") });\n        } else {\n            if (mystat.minutelyvalues.length < minutelysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATAHUMID\") });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.minutelyvalues.length; i++) {\n                    mystat.minutelyvalues[i - 1] = mystat.minutelyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.minutelyvalues[minutelysize - 1] = { epoch: current.getTime(), reading: context.get(\"DATAHUMID\") };\n            }\n        }}\n\n    // Update the hourly stats\n    if (msg.topic === \"hourly\") {\n        msg.topic = \"hourly\";\n        for (i = 0; i < minutelysize; i++) {\n                summinute += mystat.minutelyvalues[i].reading;\n        }\n        var averageminute = summinute/minutelysize;\n        // First update the historical readings\n        if (mystat.hourlyvalues===undefined) {\n            // this is the first reading, create the array first\n            mystat.hourlyvalues = [];\n            mystat.hourlyvalues.push({epoch: current.getTime(), reading:averageminute});\n        } else {\n            if (mystat.hourlyvalues.length<hourlysize-1) {\n                // there is not enough history collected yet, add to the array\n                mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute});\n            } else {\n                // the array is full need to shift values\n                for (var i=1;i<mystat.hourlyvalues.length;i++) {\n                    mystat.hourlyvalues[i-1]=mystat.hourlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.hourlyvalues[hourlysize - 1] = { epoch: current.getTime(), reading: averageminute};\n            }\n        }\n        \n    }\n   \n    // Update the daily stats\n    if (msg.topic===\"daily\") {\n        msg.topic=\"daily\";\n        for (i = 0; i < hourlysize; i++) {\n            sumhour += mystat.hourlyvalues[i].reading;\n        }\n        var averagehour = sumhour / hourlysize;\n        // First update the historical readings\n        if (mystat.dailyvalues===undefined) {\n            // this is the first reading, create the array first\n            mystat.dailyvalues = [];\n            mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour});\n        } else {\n            if (mystat.dailyvalues.length<dailysize-1) {\n                // there is not enough history collected yet, add to the array\n                mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour});\n            } else {\n                // the array is full need to shift values\n                for (var i=1;i<mystat.dailyvalues.length;i++) {\n                    mystat.dailyvalues[i-1]=mystat.dailyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.dailyvalues[dailysize - 1] = { epoch: current.getTime(), reading: averagehour};\n            }\n        }\n    }\n    \n    // Update the weekly stats\n    if (msg.topic===\"weekly\") {\n        msg.topic=\"weekly\";\n        for (i = 0; i < dailysize; i++) {\n            sumdaily += mystat.dailyvalues[i].reading;\n        }\n        var averagedaily = sumdaily / dailysize;\n        // First update the historical readings\n        if (mystat.weeklyvalues===undefined) {\n            // this is the first reading, create the array first\n            mystat.weeklyvalues = [];\n            mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily});\n        } else {\n            if (mystat.weeklyvalues.length<weeklysize-1) {\n                // there is not enough history collected yet, add to the array\n                mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily});\n            } else {\n                // the array is full need to shift values\n                for (var i=1;i<mystat.weeklyvalues.length;i++) {\n                    mystat.weeklyvalues[i-1]=mystat.weeklyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.weeklyvalues[weeklysize - 1] = { epoch: current.getTime(), reading: averagedaily};\n            }\n        }\n    }\n\n    \n    // This week rainfall calculation\n    if (mystat.weeklyvalues!==undefined) {\n        if (mystat.weeklyvalues.length>0) {\n            mystat.thisweek = Math.round((mystat.weeklyvalues[mystat.weeklyvalues.length-1].reading)*10)/10;\n            if (mystat.thisweek<0) {\n                mystat.thisweek = 0.0;\n            }\n        } else {\n            mystat.thisweek = 0.0;\n        }\n    }\n    // Today rainfall calculation\n    if (mystat.dailyvalues!==undefined) {\n        if (mystat.dailyvalues.length>0) {\n            mystat.today = mystat.dailyvalues[mystat.dailyvalues.length - 1].reading;\n            mystat.today = Math.round((mystat.today) * 10) / 10;\n            if (mystat.today<0) {\n                mystat.today = 0.0;\n            }\n        } else {\n            mystat.today = 0.0;\n        }\n    }\n    // This hour rainfall calculation\n    if (mystat.hourlyvalues!==undefined) {\n        if (mystat.hourlyvalues.length>0) {\n            mystat.thishour = mystat.hourlyvalues[mystat.hourlyvalues.length - 1].reading;\n            mystat.thishour = Math.round((mystat.thishour) * 10) / 10;\n            if (mystat.thishour<0) {\n                mystat.thishour = 0.0;\n            }\n        } else {\n            mystat.thishour = 0.0;\n        }\n    }        \n    \n    // Store the updates\n    global.set(global_name,mystat);\n    msg.payload = mystat;\n    node.status({fill:\"blue\",shape:\"ring\",text:msg.topic+\" performed\"});\n    return msg;\n} else {\n    node.status({fill:\"red\",shape:\"ring\",text:\"No reading\"});\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":860,"wires":[["c03f8282c515966f"]]},{"id":"22b040590e88ec39","type":"function","z":"e2d0491f8f79674f","name":"Sensordata soil","func":"var global_name = \"sensordatasoil\";   // Name of the global variable\nvar minutelysize = 60;\nvar hourlysize = 24;            // Number of hourly stat to collect (24 for the last 24 hours)\nvar dailysize = 14;             // Number of daily stat to collect\nvar weeklysize = 12;             // Number of weekly stat to collect\nvar monthlysize = 12;\nvar current = new Date();\nvar summinute = 0;\nvar sumhour = 0;\nvar sumdaily = 0;\nvar summweek = 0;\nvar summmonth = 0;\n\n\n\nvar mystat = global.get(global_name);\nif (mystat === undefined) {\n    mystat = {};\n}\n\n// If the message is coming from sensor, save the current value\nif (msg.topic.includes(\"sensor\")) {\n    context.set(\"DATASOIL\", msg.payload.averagesoilhumid);\n    msg.topic = \"reading\";\n}\n\n// Do not process stats until we have a valid reading\nif (context.get(\"DATASOIL\") !== undefined) {\n\n    // Update the minutely stats\n    if (msg.topic === \"minutely\") {\n        msg.topic = \"minutely\";\n        // First update the historical readings\n        if (mystat.minutelyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.minutelyvalues = [];\n            mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATASOIL\") });\n        } else {\n            if (mystat.minutelyvalues.length < minutelysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.minutelyvalues.push({ epoch: current.getTime(), reading: context.get(\"DATASOIL\") });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.minutelyvalues.length; i++) {\n                    mystat.minutelyvalues[i - 1] = mystat.minutelyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.minutelyvalues[minutelysize - 1] = { epoch: current.getTime(), reading: context.get(\"DATASOIL\") };\n            }\n        }\n    }\n\n    // Update the hourly stats\n    if (msg.topic === \"hourly\") {\n        msg.topic = \"hourly\";\n        for (i = 0; i < minutelysize; i++) {\n            summinute += mystat.minutelyvalues[i].reading;\n        }\n        var averageminute = summinute / minutelysize;\n        // First update the historical readings\n        if (mystat.hourlyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.hourlyvalues = [];\n            mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute });\n        } else {\n            if (mystat.hourlyvalues.length < hourlysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.hourlyvalues.push({ epoch: current.getTime(), reading: averageminute });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.hourlyvalues.length; i++) {\n                    mystat.hourlyvalues[i - 1] = mystat.hourlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.hourlyvalues[hourlysize - 1] = { epoch: current.getTime(), reading: averageminute };\n            }\n        }\n\n    }\n\n    // Update the daily stats\n    if (msg.topic === \"daily\") {\n        msg.topic = \"daily\";\n        for (i = 0; i < hourlysize; i++) {\n            sumhour += mystat.hourlyvalues[i].reading;\n        }\n        var averagehour = sumhour / hourlysize;\n        // First update the historical readings\n        if (mystat.dailyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.dailyvalues = [];\n            mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour });\n        } else {\n            if (mystat.dailyvalues.length < dailysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.dailyvalues.push({ epoch: current.getTime(), reading: averagehour });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.dailyvalues.length; i++) {\n                    mystat.dailyvalues[i - 1] = mystat.dailyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.dailyvalues[dailysize - 1] = { epoch: current.getTime(), reading: averagehour };\n            }\n        }\n    }\n\n    // Update the weekly stats\n    if (msg.topic === \"weekly\") {\n        msg.topic = \"weekly\";\n        for (i = 0; i < dailysize; i++) {\n            sumdaily += mystat.dailyvalues[i].reading;\n        }\n        var averagedaily = sumdaily / dailysize;\n        // First update the historical readings\n        if (mystat.weeklyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.weeklyvalues = [];\n            mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily });\n        } else {\n            if (mystat.weeklyvalues.length < weeklysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.weeklyvalues.push({ epoch: current.getTime(), reading: averagedaily });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.weeklyvalues.length; i++) {\n                    mystat.weeklyvalues[i - 1] = mystat.weeklyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.weeklyvalues[weeklysize - 1] = { epoch: current.getTime(), reading: averagedaily };\n            }\n        }\n    }\n\n    // Update the monthly stats\n    if (msg.topic === \"monthly\") {\n        msg.topic = \"monthly\";\n        for (i = 0; i < weeklysize; i++) {\n            summweek += mystat.weeklyvalues[i].reading;\n        }\n        var averageweekly = summweek / weeklysize;\n        // First update the historical readings\n        if (mystat.monthlyvalues === undefined) {\n            // this is the first reading, create the array first\n            mystat.monthlyvalues = [];\n            mystat.monthlyvalues.push({ epoch: current.getTime(), reading: averageweekly });\n        } else {\n            if (mystat.monthlyvalues.length < monthlysize - 1) {\n                // there is not enough history collected yet, add to the array\n                mystat.monthlyvalues.push({ epoch: current.getTime(), reading: averageweekly });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < mystat.monthlyvalues.length; i++) {\n                    mystat.monthlyvalues[i - 1] = mystat.monthlyvalues[i];\n                }\n                // add the current value to the end of the array\n                mystat.monthlyvalues[monthlysize - 1] = { epoch: current.getTime(), reading: averageweekly };\n            }\n        }\n    }\n\n    if (mystat.monthlyvalues !== undefined) {\n        if (mystat.monthlyvalues.length > 0) {\n            mystat.thismonth = Math.round((mystat.monthlyvalues[mystat.monthlyvalues.length - 1].reading) * 10) / 10;\n            if (mystat.thismonth < 0) {\n                mystat.thismonth = 0.0;\n            }\n        } else {\n            mystat.thismonth = 0.0;\n        }\n    }\n\n    // This week rainfall calculation\n    if (mystat.weeklyvalues !== undefined) {\n        if (mystat.weeklyvalues.length > 0) {\n            mystat.thisweek = Math.round((mystat.weeklyvalues[mystat.weeklyvalues.length - 1].reading) * 10) / 10;\n            if (mystat.thisweek < 0) {\n                mystat.thisweek = 0.0;\n            }\n        } else {\n            mystat.thisweek = 0.0;\n        }\n    }\n    // Today rainfall calculation\n    if (mystat.dailyvalues !== undefined) {\n        if (mystat.dailyvalues.length > 0) {\n            mystat.today = mystat.dailyvalues[mystat.dailyvalues.length - 1].reading;\n            mystat.today = Math.round((mystat.today) * 10) / 10;\n            if (mystat.today < 0) {\n                mystat.today = 0.0;\n            }\n        } else {\n            mystat.today = 0.0;\n        }\n    }\n    // This hour rainfall calculation\n    if (mystat.hourlyvalues !== undefined) {\n        if (mystat.hourlyvalues.length > 0) {\n            mystat.thishour = mystat.hourlyvalues[mystat.hourlyvalues.length - 1].reading;\n            mystat.thishour = Math.round((mystat.thishour) * 10) / 10;\n            if (mystat.thishour < 0) {\n                mystat.thishour = 0.0;\n            }\n        } else {\n            mystat.thishour = 0.0;\n        }\n    }\n\n    // Store the updates\n    global.set(global_name, mystat);\n    msg.payload = mystat;\n    node.status({ fill: \"blue\", shape: \"ring\", text: msg.topic + \" performed\" });\n    return msg;\n} else {\n    node.status({ fill: \"red\", shape: \"ring\", text: \"No reading\" });\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2240,"y":1020,"wires":[["96022ba5d967136c"]]},{"id":"5198a9f125d5a1c8","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":true,"onceDelay":"15","topic":"hourly","payload":"","payloadType":"date","x":2030,"y":940,"wires":[["944bbc22e72e0945","67da260229d04586","22b040590e88ec39","e8e2619fa4b6e587"]]},{"id":"ca638e70719004be","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"01 00 * * *","once":false,"onceDelay":"","topic":"daily","payload":"","payloadType":"date","x":2030,"y":1020,"wires":[["944bbc22e72e0945","67da260229d04586","22b040590e88ec39","e8e2619fa4b6e587"]]},{"id":"c03f8282c515966f","type":"switch","z":"e2d0491f8f79674f","name":"Humidity Switch","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reading","vt":"str"},{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"},{"t":"eq","v":"weekly","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":2520,"y":640,"wires":[["8e1c352c802e227d","a3e62d2871fba8f8","f2c5dae928407510"],["eaa5286992132eaf"],["c7a31bd91d6ce14b","eaa5286992132eaf"],["09f4f05f318d025f","eaa5286992132eaf"],["cf1353fc251aa4d6","eaa5286992132eaf"]]},{"id":"8e1c352c802e227d","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":1,"width":8,"height":1,"name":"","label":"This Hour Moisture","format":"{{msg.payload.thishour}} %","layout":"row-left","className":"","x":2790,"y":600,"wires":[]},{"id":"a3e62d2871fba8f8","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":8,"width":8,"height":1,"name":"","label":"Today's Moisture","format":"{{msg.payload.today}} %","layout":"row-left","className":"","x":2790,"y":640,"wires":[]},{"id":"f2c5dae928407510","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":15,"width":8,"height":1,"name":"","label":"This Week's Consumption","format":"{{msg.payload.thisweek}} %","layout":"row-left","className":"","x":2810,"y":680,"wires":[]},{"id":"c7a31bd91d6ce14b","type":"function","z":"e2d0491f8f79674f","name":"Generate hourly graph","func":"//msg.payload = global.get(\"rainstat\");  //uncomment this for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Hourly Humidity\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.hourlyvalues!==undefined) {\n    if (msg.payload.hourlyvalues.length>0) {\n        for (var i = 0; i < msg.payload.hourlyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.hourlyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.hourlyvalues[i].epoch-1000*60*60);\n            var d2 = new Date();\n            d2.setTime(msg.payload.hourlyvalues[i].epoch);\n            m.labels.push(d.getHours()+\"-\"+d2.getHours());\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2800,"y":720,"wires":[["bd58bb5a73e4249e"]]},{"id":"e30e8a3bdfc604cf","type":"inject","z":"e2d0491f8f79674f","name":"","repeat":"","crontab":"","once":false,"topic":"","payload":"","payloadType":"date","x":2540,"y":720,"wires":[["c7a31bd91d6ce14b"]]},{"id":"c3c2733379d161d9","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":"","topic":"minutely","payload":"","payloadType":"date","x":2020,"y":860,"wires":[["944bbc22e72e0945","67da260229d04586","22b040590e88ec39","e8e2619fa4b6e587"]]},{"id":"17031c8d9fc4016f","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"02 00 * * 1","once":false,"onceDelay":"","topic":"weekly","payload":"","payloadType":"date","x":2030,"y":1100,"wires":[["944bbc22e72e0945","67da260229d04586","22b040590e88ec39","e8e2619fa4b6e587"]]},{"id":"09f4f05f318d025f","type":"function","z":"e2d0491f8f79674f","name":"Generate daily graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar dL = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\nvar dS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n//msg.payload = global.get(\"rainstat\"); // uncomment this line if you want to debug\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Daily consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.dailyvalues!==undefined) {\n    if (msg.payload.dailyvalues.length>0) {\n        for (var i = 0; i < msg.payload.dailyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.dailyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.dailyvalues[i].epoch-1000*60*60*24);\n            m.labels.push(dL[d.getDay()]+\", \"+getGetOrdinal(d.getDate()));\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2800,"y":760,"wires":[["41228185994f487b"]]},{"id":"b0ac4d94e3ede01d","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2540,"y":760,"wires":[["09f4f05f318d025f"]]},{"id":"cf1353fc251aa4d6","type":"function","z":"e2d0491f8f79674f","name":"Generate weekly graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar mL = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\nvar mS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];\n//msg.payload = global.get(\"rainstat\");  // uncomment this line for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Weekly consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.weeklyvalues!==undefined) {\n    if (msg.payload.weeklyvalues.length>0) {\n        for (var i = 0; i < msg.payload.weeklyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.weeklyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.weeklyvalues[i].epoch-1000*60*60*24*7);\n            m.labels.push(\"w/c \"+getGetOrdinal(d.getDate())+\" of \"+mL[d.getMonth()]);\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2810,"y":800,"wires":[["aa205675d8b9dc7f"]]},{"id":"b6f73b0a76a72d3f","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"2d49b59fdcc351e9","order":16,"width":22,"height":5,"label":"Weekly Reading","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"no data","dot":false,"ymin":"","ymax":"","removeOlder":"12","removeOlderPoints":"12","removeOlderUnit":"604800","cutout":0,"useOneColor":true,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":4180,"y":1340,"wires":[["095885fc72f9ab59","37e8d46e084be63c"]]},{"id":"799666e471fd6857","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2540,"y":800,"wires":[["cf1353fc251aa4d6"]]},{"id":"ad4ba7d75d9067d1","type":"inject","z":"e2d0491f8f79674f","name":"Startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":3660,"y":1340,"wires":[["c870bf1951b36ad5"]]},{"id":"c870bf1951b36ad5","type":"file in","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_weekly.dump","filenameType":"str","format":"utf8","sendError":true,"allProps":false,"x":3830,"y":1340,"wires":[["514ac3e4602d42fa"]]},{"id":"514ac3e4602d42fa","type":"json","z":"e2d0491f8f79674f","name":"","x":3990,"y":1340,"wires":[["b6f73b0a76a72d3f"]]},{"id":"095885fc72f9ab59","type":"file","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_weekly.dump","filenameType":"str","appendNewline":true,"createDir":false,"overwriteFile":"true","x":4390,"y":1340,"wires":[[]]},{"id":"eaa5286992132eaf","type":"debug","z":"e2d0491f8f79674f","name":"Humidity daily","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2520,"y":580,"wires":[]},{"id":"8c72d65f.be8c8","type":"switch","z":"e2d0491f8f79674f","name":"","property":"type","propertyType":"msg","rules":[{"t":"eq","v":"Temperature","vt":"str"},{"t":"eq","v":"pH","vt":"str"},{"t":"eq","v":"Soil","vt":"str"},{"t":"eq","v":"Humidity","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":2250,"y":3460,"wires":[["952f52226e7f7946"],["ce78ba9f51dc075a"],["e9c237b75e97d5cb"],["09e1f98a576f395a"]]},{"id":"9b0e43cf502718bc","type":"grade","z":"e2d0491f8f79674f","name":"high","x0":"29","x1":"37.5","x":2590,"y":3180,"wires":[[]]},{"id":"952f52226e7f7946","type":"input","z":"e2d0491f8f79674f","name":"AIRTEMP","nid":"Temperature","x":2420,"y":3240,"wires":[["9b0e43cf502718bc","d32ee12ee695b3a4","4f3012c54d15536d","25043bd71a67cb88"]]},{"id":"ce78ba9f51dc075a","type":"input","z":"e2d0491f8f79674f","name":"pH","nid":"pH","x":2410,"y":3400,"wires":[["57d779dd551611e7","ce8288383dc9d027","259eb8714ed12bb8","cebaeaa46b678bbf"]]},{"id":"57d779dd551611e7","type":"grade","z":"e2d0491f8f79674f","name":"high","x0":"6","x1":"7","x":2590,"y":3340,"wires":[[]]},{"id":"d32ee12ee695b3a4","type":"triangle","z":"e2d0491f8f79674f","name":"mid","x0":"26","x1":"27.5","x2":"29","x":2590,"y":3220,"wires":[["3af88ffb3e003f33","8e69841f2b04f73d"]]},{"id":"ce8288383dc9d027","type":"triangle","z":"e2d0491f8f79674f","name":"mid","x0":"4","x1":"5","x2":"6","x":2590,"y":3380,"wires":[["398dca1fd0c8300a","3af88ffb3e003f33","e176bb445fb45515"]]},{"id":"84e6efff4f6ef055","type":"function","z":"e2d0491f8f79674f","name":"Temperature Format","func":"\nmsg.type = msg.payload.Temperature.type;\nmsg.payload = msg.payload.Temperature.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2060,"y":3400,"wires":[["8c72d65f.be8c8"]]},{"id":"259eb8714ed12bb8","type":"reverse grade","z":"e2d0491f8f79674f","name":"low","x0":"4","x1":"5","x":2590,"y":3420,"wires":[[]]},{"id":"4f3012c54d15536d","type":"reverse grade","z":"e2d0491f8f79674f","name":"low","x0":"26","x1":"27.5","x":2590,"y":3260,"wires":[["398dca1fd0c8300a"]]},{"id":"e9c237b75e97d5cb","type":"input","z":"e2d0491f8f79674f","name":"SoilHumidity","nid":"Soil","x":2430,"y":3560,"wires":[["0cbe044ecde01557","96e2911ebd28dab5","ffd4577cb8434f15","f1ba52cd4a6540a4"]]},{"id":"0cbe044ecde01557","type":"grade","z":"e2d0491f8f79674f","name":"high","x0":"75","x1":"85","x":2590,"y":3500,"wires":[["e176bb445fb45515"]]},{"id":"96e2911ebd28dab5","type":"triangle","z":"e2d0491f8f79674f","name":"mid","x0":"65","x1":"75","x2":"85","x":2590,"y":3540,"wires":[["398dca1fd0c8300a","3af88ffb3e003f33"]]},{"id":"ffd4577cb8434f15","type":"reverse grade","z":"e2d0491f8f79674f","name":"low","x0":"45","x1":"65","x":2590,"y":3580,"wires":[[]]},{"id":"09e1f98a576f395a","type":"input","z":"e2d0491f8f79674f","name":"AirHumid","nid":"Humidity","x":2420,"y":3720,"wires":[["ebda7a60a3e81c4b","eef66cd5d0b71e79","5829c9ebdc89aac5","46d14b9f45ab795d"]]},{"id":"ebda7a60a3e81c4b","type":"grade","z":"e2d0491f8f79674f","name":"high","x0":"80","x1":"90","x":2590,"y":3660,"wires":[["e176bb445fb45515"]]},{"id":"eef66cd5d0b71e79","type":"triangle","z":"e2d0491f8f79674f","name":"mid","x0":"60","x1":"80","x2":"90","x":2590,"y":3700,"wires":[["398dca1fd0c8300a","3af88ffb3e003f33"]]},{"id":"25043bd71a67cb88","type":"triangle","z":"e2d0491f8f79674f","name":"Optimum","x0":"27.5","x1":"30","x2":"32.5","x":2600,"y":3300,"wires":[["e176bb445fb45515","8e69841f2b04f73d"]]},{"id":"cebaeaa46b678bbf","type":"triangle","z":"e2d0491f8f79674f","name":"Optimum","x0":"5","x1":"6","x2":"7","x":2600,"y":3460,"wires":[["8e69841f2b04f73d"]]},{"id":"f1ba52cd4a6540a4","type":"triangle","z":"e2d0491f8f79674f","name":"Optimum","x0":"45","x1":"65","x2":"75","x":2600,"y":3620,"wires":[["8e69841f2b04f73d"]]},{"id":"5829c9ebdc89aac5","type":"triangle","z":"e2d0491f8f79674f","name":"Optimum","x0":"40","x1":"60","x2":"80","x":2600,"y":3780,"wires":[["8e69841f2b04f73d"]]},{"id":"398dca1fd0c8300a","type":"and","z":"e2d0491f8f79674f","name":"","minin":"4","weight":1,"complement":false,"x":2790,"y":3360,"wires":[["1fbaa1efb4ebd377"]]},{"id":"40994b26c69f4668","type":"debug","z":"e2d0491f8f79674f","name":"Minimum Growth Fusarium","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3540,"y":3360,"wires":[]},{"id":"3af88ffb3e003f33","type":"and","z":"e2d0491f8f79674f","name":"","minin":"4","weight":1,"complement":false,"x":2790,"y":3440,"wires":[["ed34a42549ed6c27"]]},{"id":"d5db6fcbc8c3bc7a","type":"debug","z":"e2d0491f8f79674f","name":"Optimum Growth Fusarium","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3540,"y":3440,"wires":[]},{"id":"e176bb445fb45515","type":"and","z":"e2d0491f8f79674f","name":"","minin":"4","weight":1,"complement":false,"x":2790,"y":3520,"wires":[["140f58f9f05f28e5"]]},{"id":"cbaaaf39215810d3","type":"debug","z":"e2d0491f8f79674f","name":"Maximum Growth Fusarium","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3540,"y":3520,"wires":[]},{"id":"8e69841f2b04f73d","type":"and","z":"e2d0491f8f79674f","name":"","minin":"4","weight":1,"complement":false,"x":2790,"y":3600,"wires":[["f79dbbf6f561e956"]]},{"id":"35ab2c6862376df8","type":"debug","z":"e2d0491f8f79674f","name":"Optimum Growth Shallot","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3530,"y":3600,"wires":[]},{"id":"40af373fee0ba9d4","type":"function","z":"e2d0491f8f79674f","name":"Optimum Fusarium","func":"msg.payload.optfs = {input : msg.payload.input,weight:msg.payload.weight,type:\"Optimum Fusarium\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3250,"y":3440,"wires":[["d5db6fcbc8c3bc7a","f65f9aaa7cbce04a"]]},{"id":"3bd0d4910284a6b6","type":"function","z":"e2d0491f8f79674f","name":"Minimum Fusarium","func":"msg.payload.min = {input : msg.payload.input,weight:msg.payload.weight,type:\"Minimum Fusarium\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3250,"y":3360,"wires":[["40994b26c69f4668","f65f9aaa7cbce04a"]]},{"id":"c3abdd0e4dc9af84","type":"function","z":"e2d0491f8f79674f","name":"Maximum Fusarium","func":"msg.payload.max = { input: msg.payload.input, weight: msg.payload.weight, type:\"Maximum  Fusarium\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3250,"y":3520,"wires":[["cbaaaf39215810d3","f65f9aaa7cbce04a"]]},{"id":"4ed995ae50f4f374","type":"function","z":"e2d0491f8f79674f","name":"Optimum Shallot","func":"msg.payload.optsh = { input: msg.payload.input, weight: msg.payload.weight, type:\"Optimum Shallot\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3240,"y":3600,"wires":[["35ab2c6862376df8","f65f9aaa7cbce04a"]]},{"id":"1fbaa1efb4ebd377","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.weight","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2950,"y":3360,"wires":[["96af2bc9bc68928d","40994b26c69f4668"]]},{"id":"ed34a42549ed6c27","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.weight","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2950,"y":3440,"wires":[["f29eba6929d8b7ec","d5db6fcbc8c3bc7a"]]},{"id":"140f58f9f05f28e5","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.weight","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2950,"y":3520,"wires":[["50e1f3a31afde38b","cbaaaf39215810d3"]]},{"id":"f79dbbf6f561e956","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.weight","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2950,"y":3600,"wires":[["294c2b2ef631dd8d","35ab2c6862376df8"]]},{"id":"f65f9aaa7cbce04a","type":"timed-counter","z":"e2d0491f8f79674f","name":"","timelimit":"4","timeunit":"1000","withhold":true,"fixedtimeout":true,"pertopic":false,"countlimit":"","x":3500,"y":3480,"wires":[["3e159f685b3b288d","f68278b3ade90354"]]},{"id":"3e159f685b3b288d","type":"delay","z":"e2d0491f8f79674f","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":3690,"y":3480,"wires":[["c6e4e357eb75c486"]]},{"id":"c6e4e357eb75c486","type":"switch","z":"e2d0491f8f79674f","name":"","property":"msg.countfuzzy","propertyType":"flow","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"gt","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":3850,"y":3480,"wires":[["3cebbb47e4fdc345","ab1ba2bcce01c1d5","451997ce7c938917","405a337ddbf1dca9","546a08d8042ae87b"],["4bc11b9929723f3e"]]},{"id":"f68278b3ade90354","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"msg.countfuzzy","pt":"flow","to":"count","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3830,"y":3280,"wires":[[]]},{"id":"3cebbb47e4fdc345","type":"debug","z":"e2d0491f8f79674f","name":"Fuzzy Result","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":4110,"y":3420,"wires":[]},{"id":"4bc11b9929723f3e","type":"function","z":"e2d0491f8f79674f","name":"Comparing Function","func":"var msgmin = msg.payload.min;\nvar msgmax = msg.payload.max;\nvar msgoptfs = msg.payload.optfs;\nvar msgoptsh = msg.payload.optsh;\n\nif(msgmin == true){\nif(msgmax == true){\n    if(msgmin.weight > msgmax.weight){\n        return msgmin;\n    }\n    else { return msgmax;}\n}else if(msgoptfs == true){\n    if(msgmin.weight > msgoptfs.weight){\n        return msgmin;\n    } else { return msgoptfs;}\n} else if (msgoptsh == true) {\n    if (msgmin.weight > msgoptsh.weight) {\n        return msgmin;\n    } else { return msgoptsh; }\n}}else if(msgoptsh == true){\n    if(msgoptfs == true){\n        if(msgoptsh.weight > msgoptfs.weight){\n            return msgoptsh ;\n        } else { return msgoptfs;}\n    }else if (msgmax == true) {\n        if (msgoptsh.weight > msgmax.weight) {\n            return msgoptsh;\n        } else { return msgmax; }\n    }\n}else if(msgoptsh == true && msgmax == true){\n    if(msgoptsh.weight > msgmax.weight){\n        return msgoptsh;\n    } else { return msgmax;}\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3940,"y":3640,"wires":[["546a08d8042ae87b","405a337ddbf1dca9","ab1ba2bcce01c1d5","3cebbb47e4fdc345","451997ce7c938917"]]},{"id":"e622d2ec296a90fb","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"4","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":1320,"wires":[["0d0de19498de1057"]]},{"id":"0d0de19498de1057","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":850,"y":1320,"wires":[["f0ddeaba49b3d84d"]]},{"id":"f0ddeaba49b3d84d","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { Temperature: msg.payload[0].averagetemp, Humidity: msg.payload[1].averagehum, Soil_Humidity: msg.payload[2].averagesoilhumid, pH: msg.payload[3].averagepH};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":1320,"wires":[["75e9538290d4b888"]]},{"id":"6db908d530e3e82d","type":"debug","z":"e2d0491f8f79674f","name":"Sensor Data Join Check","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":710,"y":1260,"wires":[]},{"id":"75e9538290d4b888","type":"function","z":"e2d0491f8f79674f","name":"FuzzyData Preparation","func":"msg.payload.Temperature = { type: \"Temperature\", value: msg.payload.Temperature};\nmsg.payload.Humidity = {type : \"Humidity\", value:msg.payload.Humidity};\nmsg.payload.Soil = {type :\"Soil\", value:msg.payload.Soil_Humidity};\nmsg.payload.pH = {type :\"pH\", value : msg.payload.pH};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1280,"y":1320,"wires":[["57f5c1c8b0c32474","38589dbf76b8e393"]]},{"id":"57f5c1c8b0c32474","type":"debug","z":"e2d0491f8f79674f","name":"Fuzzydata","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1490,"y":1280,"wires":[]},{"id":"38589dbf76b8e393","type":"link out","z":"e2d0491f8f79674f","name":"link out 7","mode":"link","links":["010b215e29dff8cc"],"x":1485,"y":1320,"wires":[]},{"id":"010b215e29dff8cc","type":"link in","z":"e2d0491f8f79674f","name":"link in 7","links":["38589dbf76b8e393"],"x":1875,"y":3460,"wires":[["84e6efff4f6ef055","b8bb3311430606a7","72baa16c34e12fdd","669cd307df08f16d"]]},{"id":"b8bb3311430606a7","type":"function","z":"e2d0491f8f79674f","name":"Humidity Format","func":"\nmsg.type = msg.payload.Humidity.type;\nmsg.payload = msg.payload.Humidity.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2040,"y":3440,"wires":[["8c72d65f.be8c8"]]},{"id":"72baa16c34e12fdd","type":"function","z":"e2d0491f8f79674f","name":"Soil_HumidityFormat","func":"msg.type = msg.payload.Soil.type;\nmsg.payload = msg.payload.Soil.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2060,"y":3520,"wires":[["8c72d65f.be8c8"]]},{"id":"669cd307df08f16d","type":"function","z":"e2d0491f8f79674f","name":"pH Format","func":"\nmsg.type = msg.payload.pH.type;\nmsg.payload = msg.payload.pH.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2030,"y":3480,"wires":[["8c72d65f.be8c8"]]},{"id":"4a22b24daf4a5071","type":"inject","z":"e2d0491f8f79674f","name":"Minimum Growth Test","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"Temperature\":26,\"Humidity\":77,\"Soil_Humidity\":75,\"pH\":5}","payloadType":"json","x":1040,"y":1160,"wires":[["75e9538290d4b888"]]},{"id":"1c655f7a6d1cbd24","type":"inject","z":"e2d0491f8f79674f","name":"Optimum Fusarium Test","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"Temperature\":27,\"Humidity\":85,\"Soil_Humidity\":80,\"pH\":5}","payloadType":"json","x":1040,"y":1200,"wires":[["75e9538290d4b888"]]},{"id":"620a5065e0d76b6c","type":"inject","z":"e2d0491f8f79674f","name":"Optimum Shallot Test","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"Temperature\":29,\"Humidity\":67,\"Soil_Humidity\":60,\"pH\":6}","payloadType":"json","x":1040,"y":1240,"wires":[["75e9538290d4b888"]]},{"id":"22bd3fbec79217de","type":"inject","z":"e2d0491f8f79674f","name":"Maximum Growth Test","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"Temperature\":29,\"Humidity\":87,\"Soil_Humidity\":84,\"pH\":5}","payloadType":"json","x":1040,"y":1280,"wires":[["75e9538290d4b888"]]},{"id":"ed5a0b4cf0558f8d","type":"comment","z":"e2d0491f8f79674f","name":"Fuzzy Logic","info":"","x":1830,"y":3220,"wires":[]},{"id":"ad3ff10c48e80cf6","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"41ba8870009b0f96","order":8,"width":6,"height":1,"passthru":false,"label":"Stop Automation","tooltip":"","color":"red","bgcolor":"black","className":"","icon":"stop","payload":"false","payloadType":"bool","topic":"topic","topicType":"msg","x":2840,"y":3940,"wires":[["ba682cbec0402d69","5cbbf78a6f2f03aa"]]},{"id":"02eb58c7abf9b78f","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"41ba8870009b0f96","order":5,"width":6,"height":1,"passthru":false,"label":"Start Automation","tooltip":"","color":"green","bgcolor":"black","className":"","icon":"power_settings_new","payload":"true","payloadType":"bool","topic":"topic","topicType":"msg","x":2850,"y":3980,"wires":[["ba682cbec0402d69","5cbbf78a6f2f03aa"]]},{"id":"ba682cbec0402d69","type":"switch","z":"e2d0491f8f79674f","name":"Automation Status","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":3070,"y":3940,"wires":[["98c9eba57cc9fbe5","e59b475f4de90db1"],["c31eb6806846ebd1","e59b475f4de90db1"]]},{"id":"98c9eba57cc9fbe5","type":"function","z":"e2d0491f8f79674f","name":"ON","func":"msg.payload = \"ON\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3250,"y":3940,"wires":[["1eaad2f584f2116a"]]},{"id":"c31eb6806846ebd1","type":"function","z":"e2d0491f8f79674f","name":"OFF","func":"msg.payload = \"OFF\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3250,"y":3980,"wires":[["1eaad2f584f2116a"]]},{"id":"1eaad2f584f2116a","type":"ui_text","z":"e2d0491f8f79674f","group":"41ba8870009b0f96","order":1,"width":7,"height":1,"name":"","label":"Fuzzy Automation Warning Status","format":"{{msg.payload}}","layout":"row-center","className":"","x":3460,"y":3960,"wires":[]},{"id":"e59b475f4de90db1","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"autostatusfuzzy","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3330,"y":4040,"wires":[[]]},{"id":"5cbbf78a6f2f03aa","type":"ui_led","z":"e2d0491f8f79674f","order":2,"group":"41ba8870009b0f96","width":2,"height":1,"label":"","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"#ff0000","value":"false","valueType":"bool"},{"color":"#008000","value":"true","valueType":"bool"}],"allowColorForValueInMessage":false,"shape":"circle","showGlow":true,"name":"","x":3030,"y":3980,"wires":[]},{"id":"96af2bc9bc68928d","type":"switch","z":"e2d0491f8f79674f","name":"","property":"autostatusfuzzy","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":3090,"y":3360,"wires":[["3bd0d4910284a6b6"]]},{"id":"f29eba6929d8b7ec","type":"switch","z":"e2d0491f8f79674f","name":"","property":"autostatusfuzzy","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":3090,"y":3440,"wires":[["40af373fee0ba9d4"]]},{"id":"50e1f3a31afde38b","type":"switch","z":"e2d0491f8f79674f","name":"","property":"autostatusfuzzy","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":3090,"y":3520,"wires":[["c3abdd0e4dc9af84"]]},{"id":"294c2b2ef631dd8d","type":"switch","z":"e2d0491f8f79674f","name":"","property":"autostatusfuzzy","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":3090,"y":3600,"wires":[["4ed995ae50f4f374"]]},{"id":"94efd88df47c0119","type":"ui_text","z":"e2d0491f8f79674f","group":"fb0aa8ebcb6c9901","order":2,"width":"3","height":1,"name":"","label":"Inject","format":"{{msg.payload.jumlahair}} ml","layout":"row-left","className":"","x":370,"y":2220,"wires":[]},{"id":"26ebef40b3940226","type":"debug","z":"e2d0491f8f79674f","name":"debug 35","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":3080,"y":4040,"wires":[]},{"id":"2c39dc838aad2aa5","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"autostatusfuzzy","payloadType":"flow","x":2870,"y":4040,"wires":[["26ebef40b3940226"]]},{"id":"ab1ba2bcce01c1d5","type":"switch","z":"e2d0491f8f79674f","name":"max","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"payload.max","vt":"msg"}],"checkall":"true","repair":false,"outputs":1,"x":4070,"y":3460,"wires":[["a8f11f28f3b333c0"]]},{"id":"451997ce7c938917","type":"switch","z":"e2d0491f8f79674f","name":"min","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"payload.min","vt":"msg"}],"checkall":"true","repair":false,"outputs":1,"x":4070,"y":3500,"wires":[["12e438c4955e191a"]]},{"id":"546a08d8042ae87b","type":"switch","z":"e2d0491f8f79674f","name":"optsh","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"payload.optsh","vt":"msg"}],"checkall":"true","repair":false,"outputs":1,"x":4070,"y":3580,"wires":[["9bfc8781024956ae"]]},{"id":"405a337ddbf1dca9","type":"switch","z":"e2d0491f8f79674f","name":"optfs","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"payload.optfs","vt":"msg"}],"checkall":"true","repair":false,"outputs":1,"x":4070,"y":3540,"wires":[["b50fb44707152c7f"]]},{"id":"a8f11f28f3b333c0","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Attention !! The environment is in danger of fusarium wilt ! (Level 3) Confidence Level : \"&msg.payload.max.weight*100&\" %\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4240,"y":3460,"wires":[["43e67294aaf24b5a","f88ed5e72fb74289"]]},{"id":"b50fb44707152c7f","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Attention !! The environment is not safe against fusarium wilt ! (Level 2) Confidence Level : \"&msg.payload.optfs.weight*100&\" %\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4240,"y":3540,"wires":[["43e67294aaf24b5a","f88ed5e72fb74289"]]},{"id":"12e438c4955e191a","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Attention !! The environment has the potential for fusarium wilt ! (Level 1) Confidence Level : \"&msg.payload.min.weight*100&\" %\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4240,"y":3500,"wires":[["43e67294aaf24b5a","f88ed5e72fb74289"]]},{"id":"9bfc8781024956ae","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Environmental conditions are very good for the growth of shallots! Confidence Level : \"&msg.payload.optsh.weight*100&\" %\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4240,"y":3580,"wires":[["43e67294aaf24b5a","f88ed5e72fb74289"]]},{"id":"c8ee9b7ce5d4c495","type":"debug","z":"e2d0491f8f79674f","name":"Notification","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":4630,"y":3480,"wires":[]},{"id":"43e67294aaf24b5a","type":"trigger","z":"e2d0491f8f79674f","name":"","op1":"","op2":"","op1type":"pay","op2type":"nul","duration":"10","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":4450,"y":3520,"wires":[["c8ee9b7ce5d4c495","921d8cf1e73a235f","5e58cea8cec28c3c"]]},{"id":"f88ed5e72fb74289","type":"debug","z":"e2d0491f8f79674f","name":"Notification Debug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":4650,"y":3640,"wires":[]},{"id":"e9355751744d5e70","type":"node-red-contrib-whatsapp-cmb-send-message","z":"e2d0491f8f79674f","name":"","account":"a78311fe38ed89d0","text":"text","inputtypemessage":"msg","rejectssl":false,"x":3780,"y":2980,"wires":[["9018ba771ad4124a"]]},{"id":"3590ed90863ba822","type":"node-red-contrib-whatsapp-cmb-send-message","z":"e2d0491f8f79674f","name":"","account":"a78311fe38ed89d0","text":"text","inputtypemessage":"msg","rejectssl":false,"x":4840,"y":3520,"wires":[[]]},{"id":"237fd848e9ee6b08","type":"function","z":"e2d0491f8f79674f","name":"Warning Log","func":"var global_name = \"warningmessage\";   // Name of the global variable\nvar warningsize = 20;\nvar current = new Date().getTime();\nconst date = new Date(current);\n\nvar warning = global.get(global_name);\nif (warning===undefined) {\n    warning = {};\n}\n\n// If the message is coming from sensor, save the current value\nif (msg.topic.includes(\"Warning\")) {\n    context.set(\"MSG\", msg.payload);\n    msg.topic =\"Warning\";\n}\n\nif (msg.topic.includes(\"clear\")){\n    warning.length = 0;\n} \n\n// Do not process stats until we have a valid reading\nif (context.get(\"MSG\")!==undefined) {\n\n    // Update the minutely stats\n    \n    msg.topic = \"Warning\";\n        // First update the historical readings\n        if (warning.warningmsg === undefined) {\n            // this is the first reading, create the array first\n            warning.warningmsg = [];\n            warning.warningmsg.unshift({ epoch: date.toLocaleString('sv'), msg: context.get(\"MSG\") });\n        } else {\n            if (warning.warningmsg.length < warningsize - 1) {\n                // there is not enough history collected yet, add to the array\n                warning.warningmsg.unshift({ epoch: date.toLocaleString('sv'), msg: context.get(\"MSG\") });\n            } else {\n                // the array is full need to shift values\n                for (var i = 1; i < warning.warningmsg.length; i++) {\n                    warning.warningmsg[i - 1] = warning.warningmsg[i];\n                }\n                // add the current value to the start of the array\n                warning.warningmsg.unshift({ epoch: date.toLocaleString('sv'), msg: context.get(\"MSG\") });\n            }\n        }\n\n    \n    // Store the updates\n    global.set(global_name, warning);\n    msg.payload = warning;\n    node.status({fill:\"blue\",shape:\"ring\",text:msg.topic+\" performed\"});\n    return msg;\n} else {\n    node.status({fill:\"red\",shape:\"ring\",text:\"No reading\"});\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1950,"y":2120,"wires":[["a16ad4989337b1bd"]]},{"id":"921d8cf1e73a235f","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"topic","pt":"msg","to":"Fuzzy Warning System","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":4640,"y":3600,"wires":[["f88ed5e72fb74289","55d3d0f90e94fc4d","cf4ac2ac0eab1941"]]},{"id":"c415248190aef649","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"topic","pt":"msg","to":"Warning System","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3580,"y":2860,"wires":[["db3e38a007de5747","cf4ac2ac0eab1941"]]},{"id":"7ed529ac2cf642a6","type":"ui_table","z":"e2d0491f8f79674f","group":"dfaa0a7552b761eb","name":"","order":1,"width":30,"height":3,"columns":[{"field":"msg","title":"Warning Message","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"epoch","title":"Time Trigger","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":2630,"y":2120,"wires":[]},{"id":"32ef18bb65871ee9","type":"debug","z":"e2d0491f8f79674f","name":"Warning Log Output","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2680,"y":2060,"wires":[]},{"id":"b54a560cb1d4e3af","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.warningmsg","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2460,"y":2060,"wires":[["32ef18bb65871ee9","7ed529ac2cf642a6"]]},{"id":"62d28fd7e72bd0ab","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"dfaa0a7552b761eb","order":3,"width":3,"height":1,"passthru":false,"label":"Clear","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"true","payloadType":"bool","topic":"topic","topicType":"msg","x":1770,"y":2180,"wires":[["2dbf56a17b0d8637"]]},{"id":"7c908a37dc690d95","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"warningmessage","payloadType":"global","x":2040,"y":2260,"wires":[["b929d3880913101e"]]},{"id":"b929d3880913101e","type":"debug","z":"e2d0491f8f79674f","name":"Global Check","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2280,"y":2260,"wires":[]},{"id":"c7255da1d5bbd5a7","type":"comment","z":"e2d0491f8f79674f","name":"Warning Log","info":"","x":1930,"y":2000,"wires":[]},{"id":"76ca524f662ea817","type":"switch","z":"e2d0491f8f79674f","name":"Temperature Switch","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reading","vt":"str"},{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"},{"t":"eq","v":"weekly","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":2480,"y":940,"wires":[["dd89c524e72d67fc","e5264df36d2f92e6","becbf18d5d43bd1f","343598bd72c87df7"],["343598bd72c87df7"],["72d93e4841e13c45","343598bd72c87df7"],["fa0ecdfe99d23276","343598bd72c87df7"],["ca243ea5e0be2a89","343598bd72c87df7"]]},{"id":"dd89c524e72d67fc","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":3,"width":8,"height":1,"name":"","label":"This Hour Temperature","format":"{{msg.payload.thishour}} 'C","layout":"row-left","className":"","x":2740,"y":900,"wires":[]},{"id":"e5264df36d2f92e6","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":10,"width":8,"height":1,"name":"","label":"Today's Temperature","format":"{{msg.payload.today}} 'C","layout":"row-left","className":"","x":2740,"y":940,"wires":[]},{"id":"becbf18d5d43bd1f","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":17,"width":8,"height":1,"name":"","label":"This Week's Temperature","format":"{{msg.payload.thisweek}} 'C","layout":"row-left","className":"","x":2750,"y":980,"wires":[]},{"id":"72d93e4841e13c45","type":"function","z":"e2d0491f8f79674f","name":"Generate hourly graph","func":"//msg.payload = global.get(\"rainstat\");  //uncomment this for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\": [\"Hourly Temperature\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.hourlyvalues!==undefined) {\n    if (msg.payload.hourlyvalues.length>0) {\n        for (var i = 0; i < msg.payload.hourlyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.hourlyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.hourlyvalues[i].epoch-1000*60*60);\n            var d2 = new Date();\n            d2.setTime(msg.payload.hourlyvalues[i].epoch);\n            m.labels.push(d.getHours()+\"-\"+d2.getHours());\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2740,"y":1020,"wires":[["73876879922be6ae"]]},{"id":"41c7ea322c04d74f","type":"inject","z":"e2d0491f8f79674f","name":"","repeat":"","crontab":"","once":false,"topic":"","payload":"","payloadType":"date","x":2480,"y":1020,"wires":[["72d93e4841e13c45"]]},{"id":"fa0ecdfe99d23276","type":"function","z":"e2d0491f8f79674f","name":"Generate daily graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar dL = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\nvar dS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n//msg.payload = global.get(\"rainstat\"); // uncomment this line if you want to debug\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Daily consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.dailyvalues!==undefined) {\n    if (msg.payload.dailyvalues.length>0) {\n        for (var i = 0; i < msg.payload.dailyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.dailyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.dailyvalues[i].epoch-1000*60*60*24);\n            m.labels.push(dL[d.getDay()]+\", \"+getGetOrdinal(d.getDate()));\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2740,"y":1060,"wires":[["9bc6c67d105c3f29"]]},{"id":"419b24b32cf85103","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2480,"y":1060,"wires":[["fa0ecdfe99d23276"]]},{"id":"ca243ea5e0be2a89","type":"function","z":"e2d0491f8f79674f","name":"Generate weekly graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar mL = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\nvar mS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];\n//msg.payload = global.get(\"rainstat\");  // uncomment this line for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Weekly consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.weeklyvalues!==undefined) {\n    if (msg.payload.weeklyvalues.length>0) {\n        for (var i = 0; i < msg.payload.weeklyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.weeklyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.weeklyvalues[i].epoch-1000*60*60*24*7);\n            m.labels.push(\"w/c \"+getGetOrdinal(d.getDate())+\" of \"+mL[d.getMonth()]);\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2750,"y":1100,"wires":[["19c258814ffc104e"]]},{"id":"059f19a835c22853","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2480,"y":1100,"wires":[["ca243ea5e0be2a89"]]},{"id":"7a0bb19213e0a231","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":4,"width":8,"height":1,"name":"","label":"This Hour Soil Humidity","format":"{{msg.payload.thishour}} %","layout":"row-left","className":"","x":2810,"y":1160,"wires":[]},{"id":"499079266b4bbd31","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":11,"width":8,"height":1,"name":"","label":"Today's Soil Humidity","format":"{{msg.payload.today}} %","layout":"row-left","className":"","x":2800,"y":1200,"wires":[]},{"id":"c8b519fec147bb42","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":18,"width":8,"height":1,"name":"","label":"This Week's Soil Humidity","format":"{{msg.payload.thisweek}} %","layout":"row-left","className":"","x":2810,"y":1240,"wires":[]},{"id":"6be91430144333a6","type":"function","z":"e2d0491f8f79674f","name":"Generate hourly graph","func":"//msg.payload = global.get(\"rainstat\");  //uncomment this for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Hourly Soil Humidity\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n\n// Transform the data\nif (msg.payload.hourlyvalues!==undefined) {\n    if (msg.payload.hourlyvalues.length>0) {\n        for (var i = 0; i < msg.payload.hourlyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.hourlyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.hourlyvalues[i].epoch-1000*60*60);\n            var d2 = new Date();\n            d2.setTime(msg.payload.hourlyvalues[i].epoch);\n            m.labels.push(d.getHours()+\"-\"+d2.getHours());\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2800,"y":1280,"wires":[["e1e6887ea5bdfaa8"]]},{"id":"e87cb552f100c901","type":"inject","z":"e2d0491f8f79674f","name":"","repeat":"","crontab":"","once":false,"topic":"","payload":"","payloadType":"date","x":2540,"y":1280,"wires":[["6be91430144333a6"]]},{"id":"902a4d57837ab9c1","type":"function","z":"e2d0491f8f79674f","name":"Generate daily graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar dL = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\nvar dS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n//msg.payload = global.get(\"rainstat\"); // uncomment this line if you want to debug\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Daily consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.dailyvalues!==undefined) {\n    if (msg.payload.dailyvalues.length>0) {\n        for (var i = 0; i < msg.payload.dailyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.dailyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.dailyvalues[i].epoch-1000*60*60*24);\n            m.labels.push(dL[d.getDay()]+\", \"+getGetOrdinal(d.getDate()));\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2800,"y":1320,"wires":[["c1996024561b4ec5"]]},{"id":"0d9a4a6dd588d4ab","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2540,"y":1320,"wires":[["902a4d57837ab9c1"]]},{"id":"a144200fa5683b95","type":"function","z":"e2d0491f8f79674f","name":"Generate weekly graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar mL = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\nvar mS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];\n//msg.payload = global.get(\"rainstat\");  // uncomment this line for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Weekly consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.weeklyvalues!==undefined) {\n    if (msg.payload.weeklyvalues.length>0) {\n        for (var i = 0; i < msg.payload.weeklyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.weeklyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.weeklyvalues[i].epoch-1000*60*60*24*7);\n            m.labels.push(\"w/c \"+getGetOrdinal(d.getDate())+\" of \"+mL[d.getMonth()]);\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2810,"y":1360,"wires":[["993d3e3b450a4382"]]},{"id":"c1c77726558dfa62","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2540,"y":1360,"wires":[["a144200fa5683b95"]]},{"id":"509c90d951e1279f","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":5,"width":8,"height":1,"name":"","label":"This Hour pH","format":"{{msg.payload.thishour}}","layout":"row-left","className":"","x":2770,"y":1440,"wires":[]},{"id":"359d7e764641dc4e","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":12,"width":8,"height":1,"name":"","label":"Today's pH","format":"{{msg.payload.today}}","layout":"row-left","className":"","x":2770,"y":1480,"wires":[]},{"id":"b2d42943663dbe83","type":"ui_text","z":"e2d0491f8f79674f","group":"2d49b59fdcc351e9","order":19,"width":8,"height":1,"name":"","label":"This Week's pH","format":"{{msg.payload.thisweek}}","layout":"row-left","className":"","x":2780,"y":1520,"wires":[]},{"id":"a657e673999ff607","type":"function","z":"e2d0491f8f79674f","name":"Generate hourly graph","func":"//msg.payload = global.get(\"rainstat\");  //uncomment this for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Hourly pH\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.hourlyvalues!==undefined) {\n    if (msg.payload.hourlyvalues.length>0) {\n        for (var i = 0; i < msg.payload.hourlyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.hourlyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.hourlyvalues[i].epoch-1000*60*60);\n            var d2 = new Date();\n            d2.setTime(msg.payload.hourlyvalues[i].epoch);\n            m.labels.push(d.getHours()+\"-\"+d2.getHours());\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2800,"y":1560,"wires":[["d6581ab064f16d6e"]]},{"id":"26f903fb2aa12ac9","type":"inject","z":"e2d0491f8f79674f","name":"","repeat":"","crontab":"","once":false,"topic":"","payload":"","payloadType":"date","x":2540,"y":1560,"wires":[["a657e673999ff607"]]},{"id":"6fc88dde7f637e6e","type":"function","z":"e2d0491f8f79674f","name":"Generate daily graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar dL = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\nvar dS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n//msg.payload = global.get(\"rainstat\"); // uncomment this line if you want to debug\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Daily consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.dailyvalues!==undefined) {\n    if (msg.payload.dailyvalues.length>0) {\n        for (var i = 0; i < msg.payload.dailyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.dailyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.dailyvalues[i].epoch-1000*60*60*24);\n            m.labels.push(dL[d.getDay()]+\", \"+getGetOrdinal(d.getDate()));\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2800,"y":1600,"wires":[["17ae12ef01a9a9d0"]]},{"id":"82759cbaf1c58033","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2540,"y":1600,"wires":[["6fc88dde7f637e6e"]]},{"id":"ceac96097b40a7f2","type":"function","z":"e2d0491f8f79674f","name":"Generate weekly graph","func":"function getGetOrdinal(n) {\n    var s=[\"th\",\"st\",\"nd\",\"rd\"],\n    v=n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n }\n\nvar mL = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\nvar mS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];\n//msg.payload = global.get(\"rainstat\");  // uncomment this line for debugging\n// Skeleton data structure for the bar graph\nvar m={\n    \"series\":[\"Weekly consumption\"],\n    \"data\":[[]],\n    \"labels\":[]\n};\n\n// Transform the data\nif (msg.payload.weeklyvalues!==undefined) {\n    if (msg.payload.weeklyvalues.length>0) {\n        for (var i = 0; i < msg.payload.weeklyvalues.length;i++) {\n            m.data[0].push(Math.round(parseFloat(msg.payload.weeklyvalues[i].reading) * 10) / 10);\n            var d = new Date();\n            d.setTime(msg.payload.weeklyvalues[i].epoch-1000*60*60*24*7);\n            m.labels.push(\"w/c \"+getGetOrdinal(d.getDate())+\" of \"+mL[d.getMonth()]);\n        }\n    }\n}\n\n\nreturn {payload:[m]};\n\n/* sample data\n\nvar m={\n    \"series\":[\"Daily rainfall\"],\n    \"data\":[[5,3,6]],\n    \"labels\":[\"D-3\",\"D-2\",\"D-1\"]\n};\n\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2810,"y":1640,"wires":[["cde016c8877f9aff"]]},{"id":"63e0ea2db564a16b","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":2540,"y":1640,"wires":[["ceac96097b40a7f2"]]},{"id":"96022ba5d967136c","type":"switch","z":"e2d0491f8f79674f","name":"Soil Humid Switch","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reading","vt":"str"},{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"},{"t":"eq","v":"weekly","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":2530,"y":1200,"wires":[["7a0bb19213e0a231","499079266b4bbd31","c8b519fec147bb42","81f004923eda7087"],["81f004923eda7087"],["6be91430144333a6","81f004923eda7087"],["902a4d57837ab9c1","81f004923eda7087"],["a144200fa5683b95","81f004923eda7087"]]},{"id":"6651ae9a4bae7342","type":"switch","z":"e2d0491f8f79674f","name":"pH Switch","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reading","vt":"str"},{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"},{"t":"eq","v":"weekly","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":2500,"y":1480,"wires":[["509c90d951e1279f","359d7e764641dc4e","b2d42943663dbe83","2f1aa89c155de694"],["2f1aa89c155de694"],["a657e673999ff607","2f1aa89c155de694"],["6fc88dde7f637e6e","2f1aa89c155de694"],["ceac96097b40a7f2","2f1aa89c155de694"]]},{"id":"343598bd72c87df7","type":"debug","z":"e2d0491f8f79674f","name":"Temperature Daily","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2470,"y":880,"wires":[]},{"id":"81f004923eda7087","type":"debug","z":"e2d0491f8f79674f","name":"Soil Humid Daily","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2520,"y":1140,"wires":[]},{"id":"2f1aa89c155de694","type":"debug","z":"e2d0491f8f79674f","name":"pH Daily","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2500,"y":1420,"wires":[]},{"id":"55767e218733b054","type":"debug","z":"e2d0491f8f79674f","name":"Average Value Check","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3200,"y":440,"wires":[]},{"id":"19d1507bf6671c62","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"2d49b59fdcc351e9","order":9,"width":22,"height":5,"label":"Daily Reading","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"no data","dot":false,"ymin":"","ymax":"","removeOlder":"14","removeOlderPoints":"14","removeOlderUnit":"86400","cutout":0,"useOneColor":true,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":4180,"y":1160,"wires":[["c5b973f9b43f5b08","73383cfaad086842"]]},{"id":"29e13547148ad568","type":"inject","z":"e2d0491f8f79674f","name":"Startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":3660,"y":1160,"wires":[["527e9cafad68ff94"]]},{"id":"527e9cafad68ff94","type":"file in","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_daily.dump","filenameType":"str","format":"utf8","sendError":true,"allProps":false,"x":3830,"y":1160,"wires":[["5d6cfe082a16d97e"]]},{"id":"5d6cfe082a16d97e","type":"json","z":"e2d0491f8f79674f","name":"","property":"payload","action":"","pretty":false,"x":3990,"y":1160,"wires":[["19d1507bf6671c62"]]},{"id":"c5b973f9b43f5b08","type":"file","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_daily.dump","filenameType":"str","appendNewline":true,"createDir":false,"overwriteFile":"true","x":4390,"y":1160,"wires":[[]]},{"id":"39f9ab17a640921a","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"2d49b59fdcc351e9","order":2,"width":22,"height":5,"label":"Hourly Reading","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"no data","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"24","removeOlderUnit":"3600","cutout":0,"useOneColor":true,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":4180,"y":980,"wires":[["249fe07ce07f7013","22f9d7454c17fccb"]]},{"id":"b85c280217b99873","type":"inject","z":"e2d0491f8f79674f","name":"Startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":3660,"y":980,"wires":[["acab37b65c6e683c"]]},{"id":"acab37b65c6e683c","type":"file in","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_hourly.dump","filenameType":"str","format":"utf8","sendError":true,"allProps":false,"x":3830,"y":980,"wires":[["60780a1d97042622"]]},{"id":"60780a1d97042622","type":"json","z":"e2d0491f8f79674f","name":"","property":"payload","action":"","pretty":false,"x":3990,"y":980,"wires":[["39f9ab17a640921a"]]},{"id":"249fe07ce07f7013","type":"file","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_hourly.dump","filenameType":"str","appendNewline":true,"createDir":false,"overwriteFile":"true","x":4390,"y":980,"wires":[[]]},{"id":"246c076b553c4cee","type":"debug","z":"e2d0491f8f79674f","name":"Chart Data Debug","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1190,"y":360,"wires":[]},{"id":"22f9d7454c17fccb","type":"debug","z":"e2d0491f8f79674f","name":"Hourly Values","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":4400,"y":1020,"wires":[]},{"id":"73383cfaad086842","type":"debug","z":"e2d0491f8f79674f","name":"Daily Reading","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":4400,"y":1200,"wires":[]},{"id":"37e8d46e084be63c","type":"debug","z":"e2d0491f8f79674f","name":"Weekly Reading","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":4400,"y":1380,"wires":[]},{"id":"d6bda38ded21444c","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"6","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":1400,"wires":[["7db6217c9ba81b3e"]]},{"id":"7db6217c9ba81b3e","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":850,"y":1400,"wires":[["b0e3c761d13b9b07"]]},{"id":"b0e3c761d13b9b07","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"if(msg.payload[2].averagesoilhumid==undefined){\n    msg.payload[2].averagesoilhumid = 0; \n}\n\nmsg.payload = { Temperature: msg.payload[0].averagetemp, Humidity: msg.payload[1].averagehum, Soil_Humidity: msg.payload[2].averagesoilhumid, pH: msg.payload[3].averagepH, timestampepoch: msg.payload[4], timestamp: msg.payload[5]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":1400,"wires":[["94ff7636e06708a7"]]},{"id":"d9951c594c02afca","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 4","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"4","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1500,"wires":[["d6bda38ded21444c"]]},{"id":"d601ee3e81753ac6","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"900","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1500,"wires":[["d9951c594c02afca","95d3710c937080ab"]]},{"id":"94ff7636e06708a7","type":"function","z":"e2d0491f8f79674f","name":"INSERT","func":"var newMsg = {\n    \"topic\": \"INSERT INTO SENSORDATA(VALUETEMP, VALUEHUMID, VALUESOILMOISTURE, VALUEPH, TIMESTAMPEPOCH, TIMESTAMP) VALUES ( \" + msg.payload.Temperature + \", \" + msg.payload.Humidity + \", \" + msg.payload.Soil_Humidity + \",\" + msg.payload.pH + \",\" + msg.payload.timestampepoch + \",'\"+msg.payload.timestamp+\"')\"\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1240,"y":1400,"wires":[["87183e492527e638"]]},{"id":"61b0ec7f52ec4909","type":"inject","z":"e2d0491f8f79674f","name":"SELECT","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":false,"onceDelay":0.1,"topic":"SELECT * FROM SENSORDATA ORDER BY TIMESTAMPEPOCH DESC LIMIT 100","payload":"","payloadType":"date","x":680,"y":1440,"wires":[["c513ab0699d4d9d1"]]},{"id":"c513ab0699d4d9d1","type":"sqlite","z":"e2d0491f8f79674f","mydb":"1c25415d.b8427f","sqlquery":"msg.topic","sql":"","name":"SENSORDATA","x":880,"y":1440,"wires":[["69406ccdc9387288","b941af4f7e80bfc4"]]},{"id":"69406ccdc9387288","type":"ui_template","z":"e2d0491f8f79674f","group":"601fe907e912562c","name":"","order":1,"width":30,"height":7,"format":"\n<table style=\"width:100%\" border = \"1\">\n  <tr>\n    <th>Temperature</th>\n    <th>Air Humidity</th> \n    <th>Soil Moisture</th>\n    <th>Soil pH</th>\n    <th>Timestamp</th>\n  </tr>\n  <tr ng-repeat=\"x in msg.payload | limitTo:20\">\n    <td style=\"text-align: center\">{{msg.payload[$index].VALUETEMP}}</td>\n    <td style=\"text-align: center\">{{msg.payload[$index].VALUEHUMID}}</td> \n    <td style=\"text-align: center\">{{msg.payload[$index].VALUESOILMOISTURE}}</td>\n    <td style=\"text-align: center\">{{msg.payload[$index].VALUEPH}}</td>\n    <td style=\"text-align: center\">{{msg.payload[$index].TIMESTAMP}}</td>\n    \n  </tr>\n</table>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","className":"","x":1080,"y":1440,"wires":[[]]},{"id":"87183e492527e638","type":"sqlite","z":"e2d0491f8f79674f","mydb":"1c25415d.b8427f","sqlquery":"msg.topic","sql":"","name":"SENSORDATA","x":1420,"y":1400,"wires":[[]]},{"id":"95d3710c937080ab","type":"function","z":"e2d0491f8f79674f","name":"Last Updated","func":"msg.payload = parseFloat(msg.payload)\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":230,"y":1540,"wires":[["3ef81d9037892dba"]]},{"id":"3ef81d9037892dba","type":"moment","z":"e2d0491f8f79674f","name":"","topic":"","input":"","inputType":"msg","inTz":"Asia/Jakarta","adjAmount":0,"adjType":"days","adjDir":"add","format":"DD.MM.YYYY HH:mm:ss","locale":"en-US","output":"","outputType":"msg","outTz":"Asia/Jakarta","x":220,"y":1580,"wires":[["6d9888cf2ecbe890"]]},{"id":"6d9888cf2ecbe890","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 5","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"5","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1540,"wires":[["d6bda38ded21444c"]]},{"id":"755e08a5.08de88","type":"comment","z":"e2d0491f8f79674f","name":"Flow to query database and format for chart","info":"","x":2030,"y":1720,"wires":[]},{"id":"3658b7ea70caeca0","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"2d49b59fdcc351e9","order":6,"width":4,"height":1,"passthru":false,"label":"Clear Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"[]","payloadType":"json","topic":"topic","topicType":"msg","x":3970,"y":1020,"wires":[["39f9ab17a640921a"]]},{"id":"61e206bd98a526c1","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"2d49b59fdcc351e9","order":20,"width":4,"height":1,"passthru":false,"label":"Clear Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"[]","payloadType":"json","topic":"topic","topicType":"msg","x":3970,"y":1380,"wires":[["b6f73b0a76a72d3f"]]},{"id":"3a40a4ef8ae80482","type":"ui_button","z":"e2d0491f8f79674f","name":"","group":"2d49b59fdcc351e9","order":13,"width":4,"height":1,"passthru":false,"label":"Clear Chart","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"[]","payloadType":"json","topic":"topic","topicType":"msg","x":3970,"y":1200,"wires":[["19d1507bf6671c62"]]},{"id":"5046006af4a009c6","type":"ui_date_picker","z":"e2d0491f8f79674f","name":"","label":"Start Date","group":"601fe907e912562c","order":6,"width":6,"height":1,"passthru":true,"topic":"topic","topicType":"msg","className":"","x":1989,"y":1830,"wires":[["e2360afb9ca0953d"]]},{"id":"1e163f50d1b92c03","type":"ui_date_picker","z":"e2d0491f8f79674f","name":"","label":"End date","group":"601fe907e912562c","order":7,"width":6,"height":1,"passthru":true,"topic":"topic","topicType":"msg","className":"","x":1989,"y":1870,"wires":[["62b302e7d398fbbc"]]},{"id":"f784f65b55d86c61","type":"function","z":"e2d0491f8f79674f","name":"SELECT TIMEFRAME","func":"var newMsg = {\n    \"topic\": \"SELECT * FROM SENSORDATA WHERE TIMESTAMPEPOCH BETWEEN \"+msg.payload.datestart+\" AND \"+msg.payload.dateend+\";\"\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2949,"y":1850,"wires":[["786795327c7201fd"]]},{"id":"b9877ea0d503f807","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":2519,"y":1850,"wires":[["86408b2e2126b15a"]]},{"id":"0f5d2abb340325ad","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2339,"y":1850,"wires":[["b9877ea0d503f807"]]},{"id":"62b302e7d398fbbc","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2129,"y":1870,"wires":[["0f5d2abb340325ad"]]},{"id":"e2360afb9ca0953d","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2129,"y":1830,"wires":[["0f5d2abb340325ad"]]},{"id":"86408b2e2126b15a","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { datestart: msg.payload[0], dateend: msg.payload[1]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2709,"y":1850,"wires":[["f784f65b55d86c61"]]},{"id":"b1c455f7389741f9","type":"function","z":"e2d0491f8f79674f","name":"DB Data to Chart data","func":"//build graph data\nlet series = [[],[],[],[]];\nlet seriesNames = [\"Temperature\", \"Humidity\", \"Soil Moisture\", \"pH\"];\n\n//loop each row and build an array in the required format\nfor (var index = 0; index < msg.payload.length; index++) {\n    const row = msg.payload[index]; \n    series[0].push({ \"x\": row.TIMESTAMPEPOCH, \"y\": row.VALUETEMP });\n    series[1].push({ \"x\": row.TIMESTAMPEPOCH, \"y\": row.VALUEHUMID });\n    series[2].push({ \"x\": row.TIMESTAMPEPOCH, \"y\": row.VALUESOILMOISTURE });\n    series[3].push({ \"x\": row.TIMESTAMPEPOCH, \"y\": row.VALUEPH });\n}\n\n//prepare payload\nmsg.payload = [\n    {\n        \"series\": seriesNames,\n        \"data\": series,\n        \"labels\": [\"\"]\n    }\n];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3389,"y":1850,"wires":[["1228185b14aab917"]]},{"id":"786795327c7201fd","type":"sqlite","z":"e2d0491f8f79674f","mydb":"1c25415d.b8427f","sqlquery":"msg.topic","sql":"","name":"SENSORDATA","x":3169,"y":1850,"wires":[["b1c455f7389741f9"]]},{"id":"04f47bfe68859de3","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"1686528000000","payloadType":"num","x":1969,"y":1790,"wires":[["e2360afb9ca0953d"]]},{"id":"798fa1135fbe9e6c","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"1686787200000","payloadType":"num","x":1969,"y":1910,"wires":[["62b302e7d398fbbc"]]},{"id":"1228185b14aab917","type":"ui_chart","z":"e2d0491f8f79674f","name":"","group":"601fe907e912562c","order":9,"width":30,"height":6,"label":"Period Data","chartType":"line","legend":"true","xformat":"D/M HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"40","removeOlderPoints":"1000","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":3619,"y":1850,"wires":[[]]},{"id":"7476a716524c4257","type":"function","z":"e2d0491f8f79674f","name":"Data to Chart data","func":"//build graph data\nlet series = [[],[],[],[]];\nlet seriesNames = [\"Hourly Temperature\", \"Hourly Humidity\", \"Hourly Soil Moisture\", \"Hourly pH\"];\nlet label = []\n\n//loop each row and build an array in the required format\nfor (var index = 0; index < msg.payload.temphour[0].data[0].length; index++) {\n    series[0].push(msg.payload.temphour[0].data[0][index]);\n    series[1].push(msg.payload.humidhour[0].data[0][index]);\n    series[2].push(msg.payload.soilhour[0].data[0][index]);\n    series[3].push(msg.payload.phhour[0].data[0][index]);\n    label.push(msg.payload.temphour[0].labels[index]);\n}\n\n//prepare payload\nmsg.payload = [\n    {\n        \"series\": seriesNames,\n        \"data\": series,\n        \"labels\": label\n    }\n];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3930,"y":940,"wires":[["39f9ab17a640921a"]]},{"id":"d17cd0e7096a8fb2","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3510,"y":940,"wires":[["92cb390e3e4bbbce"]]},{"id":"145508f4f56d95ee","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"4","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3330,"y":940,"wires":[["d17cd0e7096a8fb2"]]},{"id":"73876879922be6ae","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":920,"wires":[["145508f4f56d95ee"]]},{"id":"bd58bb5a73e4249e","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":880,"wires":[["145508f4f56d95ee"]]},{"id":"92cb390e3e4bbbce","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { temphour: msg.payload[0], humidhour: msg.payload[1], soilhour:msg.payload[2], phhour:msg.payload[3]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3700,"y":940,"wires":[["7476a716524c4257"]]},{"id":"e1e6887ea5bdfaa8","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 2","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":960,"wires":[["145508f4f56d95ee"]]},{"id":"d6581ab064f16d6e","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 3","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"3","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1000,"wires":[["145508f4f56d95ee"]]},{"id":"f0a86b72e9b86506","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3510,"y":1120,"wires":[["e0d924a49afaf545"]]},{"id":"095cebe0928bfe44","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"4","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3330,"y":1120,"wires":[["f0a86b72e9b86506"]]},{"id":"9bc6c67d105c3f29","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1100,"wires":[["095cebe0928bfe44"]]},{"id":"41228185994f487b","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1060,"wires":[["095cebe0928bfe44"]]},{"id":"c1996024561b4ec5","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 2","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1140,"wires":[["095cebe0928bfe44"]]},{"id":"17ae12ef01a9a9d0","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 3","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"3","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1180,"wires":[["095cebe0928bfe44"]]},{"id":"c5af235bbf5da07d","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3510,"y":1300,"wires":[["054cdfd4fa6604ba"]]},{"id":"be458fc93a430a47","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"4","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3330,"y":1300,"wires":[["c5af235bbf5da07d"]]},{"id":"19c258814ffc104e","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1280,"wires":[["be458fc93a430a47"]]},{"id":"aa205675d8b9dc7f","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1240,"wires":[["be458fc93a430a47"]]},{"id":"993d3e3b450a4382","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 2","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1320,"wires":[["be458fc93a430a47"]]},{"id":"cde016c8877f9aff","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 3","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"3","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3120,"y":1360,"wires":[["be458fc93a430a47"]]},{"id":"3a751f3080c04e1d","type":"function","z":"e2d0491f8f79674f","name":"Data to Chart data","func":"//build graph data\nlet series = [[],[],[],[]];\nlet seriesNames = [\"Daily Temperature\", \"Daily Humidity\", \"Daily Soil Moisture\", \"Daily pH\"];\nlet label = []\n\n//loop each row and build an array in the required format\nfor (var index = 0; index < msg.payload.tempdaily[0].data[0].length; index++) {\n    series[0].push(msg.payload.tempdaily[0].data[0][index]);\n    series[1].push(msg.payload.humiddaily[0].data[0][index]);\n    series[2].push(msg.payload.soildaily[0].data[0][index]);\n    series[3].push(msg.payload.phdaily[0].data[0][index]);\n    label.push(msg.payload.tempdaily[0].labels[index]);\n}\n\n//prepare payload\nmsg.payload = [\n    {\n        \"series\": seriesNames,\n        \"data\": series,\n        \"labels\": label\n    }\n];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3930,"y":1120,"wires":[["19d1507bf6671c62"]]},{"id":"e0d924a49afaf545","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { tempdaily: msg.payload[0], humiddaily: msg.payload[1], soildaily:msg.payload[2], phdaily:msg.payload[3]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3700,"y":1120,"wires":[["3a751f3080c04e1d"]]},{"id":"9e7ad17c31733868","type":"function","z":"e2d0491f8f79674f","name":"Data to Chart data","func":"//build graph data\nlet series = [[],[],[],[]];\nlet seriesNames = [\"Weekly Temperature\", \"Weekly Humidity\", \"Weekly Soil Moisture\", \"Weekly pH\"];\nlet label = []\n\n//loop each row and build an array in the required format\nfor (var index = 0; index < msg.payload.tempweekly[0].data[0].length; index++) {\n    series[0].push(msg.payload.tempweekly[0].data[0][index]);\n    series[1].push(msg.payload.humidweekly[0].data[0][index]);\n    series[2].push(msg.payload.soilweekly[0].data[0][index]);\n    series[3].push(msg.payload.phweekly[0].data[0][index]);\n    label.push(msg.payload.tempweekly[0].labels[index]);\n}\n\n//prepare payload\nmsg.payload = [\n    {\n        \"series\": seriesNames,\n        \"data\": series,\n        \"labels\": label\n    }\n];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3930,"y":1300,"wires":[["b6f73b0a76a72d3f"]]},{"id":"054cdfd4fa6604ba","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { tempweekly: msg.payload[0], humidweekly: msg.payload[1], soilweekly:msg.payload[2], phweekly:msg.payload[3]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3700,"y":1300,"wires":[["9e7ad17c31733868"]]},{"id":"2db9a612dd4b7905","type":"link in","z":"e2d0491f8f79674f","name":"link in 8","links":["ce7b807acd540a6e"],"x":2095,"y":820,"wires":[["944bbc22e72e0945"]]},{"id":"b75a12a9ef2d5a28","type":"link in","z":"e2d0491f8f79674f","name":"link in 9","links":["30a8d330be816071"],"x":2095,"y":900,"wires":[["67da260229d04586"]]},{"id":"d960e5c3f84ba593","type":"link in","z":"e2d0491f8f79674f","name":"link in 10","links":["c8b14bc46039a64a"],"x":2095,"y":980,"wires":[["22b040590e88ec39"]]},{"id":"a4a469a9b2a27442","type":"link in","z":"e2d0491f8f79674f","name":"link in 11","links":["97609dd4d3d48907"],"x":2095,"y":1060,"wires":[["e8e2619fa4b6e587"]]},{"id":"4c75cc0f74b2f6fd","type":"comment","z":"e2d0491f8f79674f","name":"Hourly,Daily and Weekly Chart","info":"","x":1980,"y":540,"wires":[]},{"id":"138cded3e04d2a92","type":"link in","z":"e2d0491f8f79674f","name":"link in 12","links":["55d3d0f90e94fc4d","db3e38a007de5747","304ee30462c1c4d6"],"x":1825,"y":2120,"wires":[["237fd848e9ee6b08"]]},{"id":"db3e38a007de5747","type":"link out","z":"e2d0491f8f79674f","name":"link out 8","mode":"link","links":["138cded3e04d2a92"],"x":3705,"y":2860,"wires":[]},{"id":"55d3d0f90e94fc4d","type":"link out","z":"e2d0491f8f79674f","name":"link out 9","mode":"link","links":["138cded3e04d2a92"],"x":4795,"y":3600,"wires":[]},{"id":"560982b366bf6d63","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"temperature\":23,\"humidity\":50,\"soilhumidity\":45,\"pH\":5.6}","payloadType":"json","x":410,"y":660,"wires":[["99eefedaf97ec6b4"]]},{"id":"2329aa45f2db918c","type":"comment","z":"e2d0491f8f79674f","name":"CONNECT THIS NODE TO COMPLETE PROCESS","info":"","x":570,"y":2660,"wires":[]},{"id":"5956025cc29b612c","type":"function","z":"e2d0491f8f79674f","name":"Value Extraction","func":"msg.payload.valuetemperature = parseFloat(msg.payload.value.temperature);\nmsg.payload.valuehumidity = parseFloat(msg.payload.value.humidity);\nmsg.payload.valuesoil = parseFloat(msg.payload.value.soilhumid);\nmsg.payload.valuepH = parseFloat(msg.payload.value.pH);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":480,"wires":[["0f3dd3433c5036bb","e5744f895b421d1f","27a998e2325d759a","53f09a299a785b37"]]},{"id":"e93d8b0acda0de17","type":"ui_form","z":"e2d0491f8f79674f","name":"","label":"pH Warning","group":"79af5a6d262b719f","order":13,"width":0,"height":0,"options":[{"label":"pH Lower Limit (2-6)","value":"pHbawah","type":"number","required":true,"rows":null},{"label":"pH Upper Limit (7-10)","value":"pHatas","type":"number","required":true,"rows":null}],"formValue":{"pHbawah":"","pHatas":""},"payload":"","submit":"submit","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":170,"y":2560,"wires":[["b045660014fc73b9"]]},{"id":"c07697517838486e","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":9,"width":5,"height":1,"name":"","label":"pH >","format":"{{msg.payload.pHatas}}","layout":"row-left","className":"","x":890,"y":2560,"wires":[]},{"id":"6679644447d62460","type":"ui_text","z":"e2d0491f8f79674f","group":"79af5a6d262b719f","order":8,"width":5,"height":1,"name":"","label":"pH <","format":"{{msg.payload.pHbawah}}","layout":"row-left","className":"","x":650,"y":2580,"wires":[]},{"id":"09b7e933563551f1","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"pHset","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":2540,"wires":[[]]},{"id":"1cfdc68ff4d35f19","type":"switch","z":"e2d0491f8f79674f","name":"pH","property":"payload.pH","propertyType":"msg","rules":[{"t":"gte","v":"payload.batasph.pHatas","vt":"msg"},{"t":"lte","v":"payload.batasph.pHbawah","vt":"msg"},{"t":"btwn","v":"payload.batasph.pHbawah","vt":"msg","v2":"payload.batasph.pHatas","v2t":"msg"}],"checkall":"false","repair":false,"outputs":3,"x":1210,"y":3120,"wires":[["1e11ba65768ae53f"],["e565f2f70a7729ea"],["dcd881fbf92af5be"]]},{"id":"5eaa8daf1604931b","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload.warningph","pt":"msg","to":"\"Soil pH right now is : \"  & msg.payload.phres.pH & \" \" &msg.payload.phres.kondisi& \" set parameter\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":3120,"wires":[["c728ab33f601a560"]]},{"id":"1e11ba65768ae53f","type":"function","z":"e2d0491f8f79674f","name":"Diatas","func":"msg.payload.phres = {pH : msg.payload.pH, kondisi : \"above\",status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1390,"y":3080,"wires":[["5eaa8daf1604931b"]]},{"id":"e565f2f70a7729ea","type":"function","z":"e2d0491f8f79674f","name":"Dibawah","func":"msg.payload.phres = { pH: msg.payload.pH, kondisi : \"below\", status : true}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":3120,"wires":[["5eaa8daf1604931b"]]},{"id":"1d47aac6cdcdd2ef","type":"join","z":"e2d0491f8f79674f","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"5","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":830,"y":3120,"wires":[["d64649d7a70dd216"]]},{"id":"284255087356c222","type":"change","z":"e2d0491f8f79674f","name":"group id and count","rules":[{"t":"set","p":"parts.id","pt":"msg","to":"mygroup","tot":"str"},{"t":"set","p":"parts.count","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":3120,"wires":[["1d47aac6cdcdd2ef"]]},{"id":"451d804a716d2424","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 1","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":3140,"wires":[["284255087356c222","83e82a26d40a5e8c"]]},{"id":"c1ba90bf57ecb674","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 0","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":3100,"wires":[["284255087356c222","83e82a26d40a5e8c"]]},{"id":"d64649d7a70dd216","type":"function","z":"e2d0491f8f79674f","name":"Extract Join to Object","func":"msg.payload = { pH: msg.payload[0].averagepH, batasph: msg.payload[1]};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":3120,"wires":[["1cfdc68ff4d35f19","c1a16d5e61da1be5"]]},{"id":"1722f4fca56ed843","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"pHset","payloadType":"flow","x":250,"y":3140,"wires":[["451d804a716d2424"]]},{"id":"bc470a0725053c9a","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 3","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"3","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2540,"y":3120,"wires":[["301439d744a2bd78"]]},{"id":"c728ab33f601a560","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload.phres.status","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1870,"y":3120,"wires":[["34505621a24b0cbf"]]},{"id":"cf3d45e66a382071","type":"delay","z":"e2d0491f8f79674f","name":"","pauseType":"delay","timeout":"6","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2240,"y":3120,"wires":[["957669dd8345e630"]]},{"id":"957669dd8345e630","type":"switch","z":"e2d0491f8f79674f","name":"","property":"msg.count","propertyType":"flow","rules":[{"t":"neq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2370,"y":3120,"wires":[["bc470a0725053c9a"]]},{"id":"c527cb4fe76d4020","type":"inject","z":"e2d0491f8f79674f","name":"phtrue","props":[{"p":"payload.pHres.warningsoil","v":"true","vt":"bool"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":1690,"y":3080,"wires":[["c728ab33f601a560"]]},{"id":"34505621a24b0cbf","type":"function","z":"e2d0491f8f79674f","name":"warningpH extract","func":"msg.payload = msg.payload.warningph;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2050,"y":3120,"wires":[["cf3d45e66a382071","9cf1c93c9580acd8"]]},{"id":"dcd881fbf92af5be","type":"function","z":"e2d0491f8f79674f","name":"Normal","func":"msg.payload.phres = { pH: msg.payload.pH, status : false}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":3160,"wires":[["5eaa8daf1604931b"]]},{"id":"c1a16d5e61da1be5","type":"debug","z":"e2d0491f8f79674f","name":"debug 36","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1220,"y":3180,"wires":[]},{"id":"82b7324daa9107bc","type":"debug","z":"e2d0491f8f79674f","name":"debug 38","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":2380,"y":520,"wires":[]},{"id":"e747cfe0aab5508f","type":"function","z":"e2d0491f8f79674f","name":"Value Extraction","func":"msg.payload.valuetemperature = parseFloat(msg.payload.value.temperature);\nmsg.payload.valuehumidity = parseFloat(msg.payload.value.humidity);\nmsg.payload.valuesoil = parseFloat(msg.payload.value.soilhumid);\nmsg.payload.valuepH = parseFloat(msg.payload.value.pH);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":720,"wires":[["2114e71fe35c3b09","b0716083d914ef5e","c34d7a57bfa5a994","4d7c5941fec353ac"]]},{"id":"8343031f3408f77d","type":"function","z":"e2d0491f8f79674f","name":"Last Updated","func":"msg.payload = parseFloat(msg.payload.datetime)\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":760,"wires":[["965c8157cc833301"]]},{"id":"9fc8e6b3c1253535","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 5","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"5","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1460,"wires":[["70ce1251b99d2c94"]]},{"id":"1dcd4b8e79bfaa1b","type":"change","z":"e2d0491f8f79674f","name":"parts.index = 4","rules":[{"t":"set","p":"parts.index","pt":"msg","to":"4","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":1420,"wires":[["70ce1251b99d2c94"]]},{"id":"3f905dbb604452d8","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"13","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"autosetting","payloadType":"flow","x":230,"y":1420,"wires":[["1dcd4b8e79bfaa1b"]]},{"id":"b92c0b115aaf3f76","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"autostatus","payloadType":"flow","x":240,"y":1460,"wires":[["9fc8e6b3c1253535"]]},{"id":"0a7a24a6b93e093c","type":"inject","z":"e2d0491f8f79674f","name":"SELECT","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":false,"onceDelay":0.1,"topic":"SELECT * FROM SENSORDATA ORDER BY TIMESTAMP DESC LIMIT 100","payload":"","payloadType":"date","x":680,"y":1520,"wires":[[]]},{"id":"d745b337b9b1e352","type":"function","z":"e2d0491f8f79674f","name":"function 1","func":"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2220,"y":560,"wires":[[]]},{"id":"cc2e8e5b76b471d3","type":"function","z":"e2d0491f8f79674f","name":"Last Updated","func":"msg.payload = parseFloat(msg.payload.datetime)\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":520,"wires":[["223e86700ede5ff0"]]},{"id":"183ec7aa3a296ea5","type":"file","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_average.dump","filenameType":"str","appendNewline":true,"createDir":false,"overwriteFile":"true","x":4010,"y":380,"wires":[[]]},{"id":"6d141144f99b89d2","type":"inject","z":"e2d0491f8f79674f","name":"Startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"","payloadType":"date","x":3480,"y":440,"wires":[["31e229c85d896a6c"]]},{"id":"31e229c85d896a6c","type":"file in","z":"e2d0491f8f79674f","name":"Chart dump","filename":"/home/pi/charts/sensor_average.dump","filenameType":"str","format":"utf8","sendError":true,"allProps":false,"x":3650,"y":440,"wires":[["3b9de6986b8da11a"]]},{"id":"3b9de6986b8da11a","type":"json","z":"e2d0491f8f79674f","name":"","property":"payload","action":"","pretty":false,"x":3810,"y":440,"wires":[["e58e612fda332b05"]]},{"id":"39674cd4a5fb15d7","type":"link in","z":"e2d0491f8f79674f","name":"link in 13","links":["30a8d330be816071"],"x":275,"y":2740,"wires":[["e494d4b95e493a13"]]},{"id":"fcaeeb033097bc03","type":"link in","z":"e2d0491f8f79674f","name":"link in 14","links":["ce7b807acd540a6e"],"x":275,"y":2860,"wires":[["0c7995fb8834d480"]]},{"id":"c5f282fe14d9874f","type":"link in","z":"e2d0491f8f79674f","name":"link in 15","links":["c8b14bc46039a64a"],"x":275,"y":2980,"wires":[["bc8f4fa74b637e58"]]},{"id":"db5b03cdbae046a0","type":"link in","z":"e2d0491f8f79674f","name":"link in 16","links":["97609dd4d3d48907"],"x":275,"y":3100,"wires":[["c1ba90bf57ecb674"]]},{"id":"83e82a26d40a5e8c","type":"debug","z":"e2d0491f8f79674f","name":"debug 39","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":620,"y":3160,"wires":[]},{"id":"46d14b9f45ab795d","type":"reverse grade","z":"e2d0491f8f79674f","name":"low","x0":"40","x1":"60","x":2590,"y":3740,"wires":[[]]},{"id":"837ecd47bc4ddd28","type":"debug","z":"e2d0491f8f79674f","name":"debug 40","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":780,"y":880,"wires":[]},{"id":"39c0f5bf6628bf24","type":"inject","z":"e2d0491f8f79674f","name":"3","props":[{"p":"payload.averagepH","v":"3","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":3060,"wires":[["c1ba90bf57ecb674"]]},{"id":"dc9ade07158bb4dd","type":"inject","z":"e2d0491f8f79674f","name":"20","props":[{"p":"payload.averagesoilhumid","v":"20","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2940,"wires":[["bc8f4fa74b637e58"]]},{"id":"fbf7e9144cdb93e0","type":"inject","z":"e2d0491f8f79674f","name":"50","props":[{"p":"payload.averagesoilhumid","v":"50","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2980,"wires":[["bc8f4fa74b637e58"]]},{"id":"5473b72ce15e9d31","type":"inject","z":"e2d0491f8f79674f","name":"80","props":[{"p":"payload.averagehum","v":"80","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2900,"wires":[["0c7995fb8834d480"]]},{"id":"0ffbd1f40cc26b7f","type":"inject","z":"e2d0491f8f79674f","name":"50","props":[{"p":"payload.averagehum","v":"50","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2860,"wires":[["0c7995fb8834d480"]]},{"id":"5fa16489939417f0","type":"inject","z":"e2d0491f8f79674f","name":"50","props":[{"p":"payload.averagetemp","v":"50","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2780,"wires":[["e494d4b95e493a13"]]},{"id":"ee43cd794e114dc3","type":"inject","z":"e2d0491f8f79674f","name":"10","props":[{"p":"payload.averagetemp","v":"10","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":2700,"wires":[["e494d4b95e493a13"]]},{"id":"08b3035cbbcd3b49","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"text","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3570,"y":2940,"wires":[["a87c8e8fa5baf5e0","e9355751744d5e70"]]},{"id":"9018ba771ad4124a","type":"debug","z":"e2d0491f8f79674f","name":"debug 41","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":3940,"y":2980,"wires":[]},{"id":"f18194065d5ef2f8","type":"debug","z":"e2d0491f8f79674f","name":"debug 42","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3540,"y":3040,"wires":[]},{"id":"18dae069b1c0d551","type":"inject","z":"e2d0491f8f79674f","name":"7","props":[{"p":"payload.averagepH","v":"7","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":3100,"wires":[["c1ba90bf57ecb674"]]},{"id":"c19fcbdb4030d5f8","type":"inject","z":"e2d0491f8f79674f","name":"10","props":[{"p":"payload.averagepH","v":"10","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":90,"y":3140,"wires":[["c1ba90bf57ecb674"]]},{"id":"282c1a64cb3485a2","type":"debug","z":"e2d0491f8f79674f","name":"debug 43","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":920,"y":2000,"wires":[]},{"id":"8e2c45e2e8790a62","type":"debug","z":"e2d0491f8f79674f","name":"debug 44","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":380,"y":2120,"wires":[]},{"id":"8bf7805f1fe81f2c","type":"inject","z":"e2d0491f8f79674f","name":"3","props":[{"p":"payload.averagepH","v":"3","vt":"num"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":110,"y":1380,"wires":[["6ef7fd2ebe1c5848"]]},{"id":"4019a5a52808d871","type":"inject","z":"e2d0491f8f79674f","name":"10","props":[{"p":"payload.averagepH","v":"10","vt":"num"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":110,"y":1340,"wires":[["6ef7fd2ebe1c5848"]]},{"id":"514be21f5b9ef774","type":"inject","z":"e2d0491f8f79674f","name":"40","props":[{"p":"payload.averagesoilhumid","v":"40","vt":"num"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":110,"y":1300,"wires":[["5cdb2dc10e1214bc"]]},{"id":"0fdb8f4125d6c4dd","type":"inject","z":"e2d0491f8f79674f","name":"50","props":[{"p":"payload.averagehum","v":"50","vt":"num"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":110,"y":1260,"wires":[["a783c28f4b214a78"]]},{"id":"1266a9282a451332","type":"inject","z":"e2d0491f8f79674f","name":"30","props":[{"p":"payload.averagetemp","v":"30","vt":"num"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":110,"y":1220,"wires":[["e3510d0237bddd82"]]},{"id":"5e58cea8cec28c3c","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"text","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4650,"y":3520,"wires":[["3590ed90863ba822"]]},{"id":"955f1d92155a1149","type":"function","z":"e2d0491f8f79674f","name":"function 2","func":"msg.payload = { msgType: \"DATA\", jumlahair : msg.payload.jumlahair}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1080,"y":2080,"wires":[["6357d58a3faeb863","8e132d903e298886"]]},{"id":"6357d58a3faeb863","type":"debug","z":"e2d0491f8f79674f","name":"debug 45","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1260,"y":2120,"wires":[]},{"id":"d74a8a85cc30a26a","type":"trigger","z":"e2d0491f8f79674f","name":"","op1":"","op2":"","op1type":"nul","op2type":"payl","duration":"15","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":910,"y":2080,"wires":[["955f1d92155a1149"]]},{"id":"9e0de804e27c89eb","type":"link in","z":"e2d0491f8f79674f","name":"link in 17","links":["8e132d903e298886"],"x":105,"y":1020,"wires":[["5257d77cd50707ee"]]},{"id":"8e132d903e298886","type":"link out","z":"e2d0491f8f79674f","name":"link out 10","mode":"link","links":["9e0de804e27c89eb"],"x":1205,"y":2080,"wires":[]},{"id":"51fb03bfac904f9d","type":"link out","z":"e2d0491f8f79674f","name":"link out 11","mode":"link","links":["be0baf944d2a2a4c","fc4489d8b3942720"],"x":345,"y":960,"wires":[]},{"id":"be0baf944d2a2a4c","type":"link in","z":"e2d0491f8f79674f","name":"link in 18","links":["51fb03bfac904f9d"],"x":385,"y":600,"wires":[["99eefedaf97ec6b4"]]},{"id":"fc4489d8b3942720","type":"link in","z":"e2d0491f8f79674f","name":"link in 19","links":["51fb03bfac904f9d"],"x":1735,"y":320,"wires":[["4af765e829dad5ce","3855c65d4a4b21b7","ca7a6c83f3dac33b","20ce827b6dbcee0d"]]},{"id":"8a02b6b7f3e3274e","type":"switch","z":"e2d0491f8f79674f","name":"Temperatur Validation","property":"payload.tempbawah","propertyType":"msg","rules":[{"t":"gte","v":"payload.tempatas","vt":"msg"},{"t":"lt","v":"payload.tempatas","vt":"msg"}],"checkall":"true","repair":false,"outputs":2,"x":440,"y":2320,"wires":[["5c3509020622c68d"],["f464f53a6c9069b4","acc38039b7819333","3ded0a9b6151521e"]]},{"id":"c084e08fa3160957","type":"switch","z":"e2d0491f8f79674f","name":"Humidity Validation","property":"payload.humidbawah","propertyType":"msg","rules":[{"t":"gte","v":"payload.humidatas","vt":"msg"},{"t":"lt","v":"payload.humidatas","vt":"msg"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":2400,"wires":[["5c3509020622c68d"],["7e5fa9294a7f2348","8306df51256849d4","98e576548540c0d5"]]},{"id":"97c381109328cb34","type":"switch","z":"e2d0491f8f79674f","name":"Soil Validation","property":"payload.soilbawah","propertyType":"msg","rules":[{"t":"gte","v":"payload.soilatas","vt":"msg"},{"t":"lt","v":"payload.soilatas","vt":"msg"}],"checkall":"true","repair":false,"outputs":2,"x":420,"y":2480,"wires":[["5c3509020622c68d"],["3a72c778d7071737","c7b6a5d58a8c9dae","c932edcd3b795b8c"]]},{"id":"b045660014fc73b9","type":"switch","z":"e2d0491f8f79674f","name":"pH Validation","property":"payload.pHbawah","propertyType":"msg","rules":[{"t":"gte","v":"payload.pHatas","vt":"msg"},{"t":"lt","v":"payload.pHatas","vt":"msg"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":2560,"wires":[["5c3509020622c68d"],["09b7e933563551f1","6679644447d62460","c07697517838486e"]]},{"id":"5525f2e5334637c3","type":"ui_toast","z":"e2d0491f8f79674f","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1590,"y":2440,"wires":[]},{"id":"5c3509020622c68d","type":"change","z":"e2d0491f8f79674f","name":"Not Valid","rules":[{"t":"set","p":"topic","pt":"msg","to":"Invalid Value","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"Input Lower Value than Higher Limit","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1100,"y":2440,"wires":[["5525f2e5334637c3"]]},{"id":"a16ad4989337b1bd","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"warninglog","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2150,"y":2120,"wires":[[]]},{"id":"5c5c025736cdb5e1","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"warninglog","payloadType":"flow","x":2250,"y":2060,"wires":[["b54a560cb1d4e3af"]]},{"id":"9ce30d42cadf7b81","type":"debug","z":"e2d0491f8f79674f","name":"debug 46","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":2960,"y":2280,"wires":[]},{"id":"7c0138a15a32585e","type":"inject","z":"e2d0491f8f79674f","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"warninglog","payloadType":"flow","x":2740,"y":2280,"wires":[["9ce30d42cadf7b81"]]},{"id":"dc917cb2d7e6b7df","type":"function","z":"e2d0491f8f79674f","name":"function 3","func":"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2460,"y":2120,"wires":[[]]},{"id":"59fe6498c9865cbe","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"warninglog.warningmsg","pt":"flow","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2110,"y":2180,"wires":[["0b45bb4d75bfd2b3"]]},{"id":"2dbf56a17b0d8637","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1890,"y":2180,"wires":[["59fe6498c9865cbe"]]},{"id":"0b45bb4d75bfd2b3","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Warning log will be cleared in the next update","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"Clear Warning Log","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":2180,"wires":[["5525f2e5334637c3"]]},{"id":"5fd018a3d4c176a2","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Fuzzy Warning System Started","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"Fuzzy System","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3280,"y":4080,"wires":[[]]},{"id":"04965c7fa379bb3e","type":"ui_toast","z":"e2d0491f8f79674f","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"Cancel","cancel":"Ok","raw":false,"className":"","topic":"","name":"","x":210,"y":1900,"wires":[["eec5c6fbc8ac47e3"]]},{"id":"2f585adc6c4a7ca0","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"We are not responsible for this system action, please proceed carefully !","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"System Warning","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":1860,"wires":[["04965c7fa379bb3e"]]},{"id":"eec5c6fbc8ac47e3","type":"switch","z":"e2d0491f8f79674f","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"Cancel","vt":"str"},{"t":"eq","v":"Ok","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":1900,"wires":[[],["70b7f59417f88dbe"]]},{"id":"f1b5cd66529791ed","type":"debug","z":"e2d0491f8f79674f","name":"debug 47","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":740,"y":1900,"wires":[]},{"id":"70b7f59417f88dbe","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":1900,"wires":[["f1b5cd66529791ed","9faf8ec81ceb8e2d","1720c64a4dfd38a6","bf9d5401a8612ecf"]]},{"id":"bf88ba3af11f005c","type":"moment","z":"e2d0491f8f79674f","name":"","topic":"","input":"","inputType":"msg","inTz":"Asia/Jakarta","adjAmount":0,"adjType":"days","adjDir":"add","format":"","locale":"en-US","output":"","outputType":"msg","outTz":"Asia/Jakarta","x":3400,"y":1900,"wires":[[]]},{"id":"4a2cdba23df0ed88","type":"change","z":"e2d0491f8f79674f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.msg","tot":"msg"},{"t":"set","p":"topic","pt":"msg","to":"Injection Warning","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":2260,"wires":[["5525f2e5334637c3","304ee30462c1c4d6"]]},{"id":"e1da1e7a74620c0b","type":"function","z":"e2d0491f8f79674f","name":"function 4","func":"msg.payload = {msg : \"Injecting \"+msg.payload.jumlahair+\" ml\", time : Date.now()};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400,"y":2260,"wires":[["4a2cdba23df0ed88","8c16ea1a8d5da5bf"]]},{"id":"f63205a1d9185095","type":"ui_text","z":"e2d0491f8f79674f","group":"fb0aa8ebcb6c9901","order":3,"width":"6","height":1,"name":"","label":"at ","format":"{{msg.payload.time}}","layout":"row-left","className":"","x":730,"y":2180,"wires":[]},{"id":"8c16ea1a8d5da5bf","type":"moment","z":"e2d0491f8f79674f","name":"","topic":"","input":"payload.time","inputType":"msg","inTz":"Asia/Jakarta","adjAmount":0,"adjType":"days","adjDir":"add","format":"DD.MM.YYYY HH:mm:ss","locale":"en-US","output":"payload.time","outputType":"msg","outTz":"Asia/Jakarta","x":540,"y":2220,"wires":[["f63205a1d9185095"]]},{"id":"e4863d68de1957b7","type":"comment","z":"e2d0491f8f79674f","name":"Test Warning Logic","info":"","x":110,"y":2660,"wires":[]},{"id":"389cca6e72816f6f","type":"comment","z":"e2d0491f8f79674f","name":"Test pH Balancer System","info":"","x":110,"y":1180,"wires":[]},{"id":"a6ddf9fee7875084","type":"comment","z":"e2d0491f8f79674f","name":"Test Fuzzy Logic","info":"","x":1000,"y":1120,"wires":[]},{"id":"304ee30462c1c4d6","type":"link out","z":"e2d0491f8f79674f","name":"link out 12","mode":"link","links":["138cded3e04d2a92"],"x":995,"y":2240,"wires":[]},{"id":"bb74cf1b69a8e110","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"dfaa0a7552b761eb","order":2,"width":13,"height":1},{"id":"2bb4953b3ab29b51","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"dfaa0a7552b761eb","order":4,"width":14,"height":1},{"id":"755230a9e1b98d66","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":1,"width":1,"height":1},{"id":"36a7de4bfa56c354","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":6,"width":2,"height":1},{"id":"fed89866d5713d84","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":7,"width":1,"height":1},{"id":"458c978d9dc1ca66","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":8,"width":2,"height":1},{"id":"6de44e69cf71404b","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":9,"width":1,"height":1},{"id":"74475cebb12961a4","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":10,"width":2,"height":1},{"id":"77f24895d6fc10cc","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":11,"width":1,"height":1},{"id":"e410698967fc9095","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":12,"width":2,"height":1},{"id":"ac489351a35189e1","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":16,"width":19,"height":1},{"id":"cae8dd50a2f304a3","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":19,"width":4,"height":1},{"id":"8d8a6c1598d5bc9f","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"62db7c629df26146","order":21,"width":14,"height":1},{"id":"bb40d3eb4cac5adf","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"c52e7deb289caa8e","order":6,"width":3,"height":1},{"id":"1ca8fdc11dabdf87","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"c52e7deb289caa8e","order":8,"width":3,"height":1},{"id":"506b77d5e775f00a","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"442a04fa8d8550a1","order":6,"width":3,"height":1},{"id":"835453b7b87f6a5e","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"442a04fa8d8550a1","order":8,"width":3,"height":1},{"id":"10cfc14adda25af2","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"d0d4883bc2e966fc","order":3,"width":5,"height":1},{"id":"17f64982700088ea","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"41ba8870009b0f96","order":3,"width":1,"height":1},{"id":"87f31eb88cedbcbf","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"41ba8870009b0f96","order":4,"width":2,"height":1},{"id":"682a1b603b2243f8","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"41ba8870009b0f96","order":6,"width":2,"height":1},{"id":"26ef3d651b7f0b21","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"41ba8870009b0f96","order":7,"width":2,"height":1},{"id":"db922cc550e95aee","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"41ba8870009b0f96","order":9,"width":2,"height":1},{"id":"a67926bd9326811f","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"2d49b59fdcc351e9","order":7,"width":4,"height":1},{"id":"2986ef56bd7c192b","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"2d49b59fdcc351e9","order":14,"width":4,"height":1},{"id":"5bd88b7949afe6b7","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"2d49b59fdcc351e9","order":21,"width":4,"height":1},{"id":"26701e43ba7c3ae7","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"601fe907e912562c","order":4,"width":22,"height":1},{"id":"7b77b9cea73f4867","type":"ui_spacer","z":"e2d0491f8f79674f","name":"spacer","group":"601fe907e912562c","order":8,"width":18,"height":1},{"id":"f02d30787e2b888d","type":"mqtt-broker","name":"HIS","broker":"192.168.177.199","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"userProps":"","sessionExpiry":""},{"id":"c52e7deb289caa8e","type":"ui_group","name":"Board 1","tab":"ea17d14df6885fe4","order":4,"disp":true,"width":"10","collapse":false,"className":""},{"id":"442a04fa8d8550a1","type":"ui_group","name":"Board 2","tab":"ea17d14df6885fe4","order":5,"disp":true,"width":"10","collapse":false,"className":""},{"id":"62db7c629df26146","type":"ui_group","name":"Average Value","tab":"ea17d14df6885fe4","order":2,"disp":true,"width":"30","collapse":false,"className":""},{"id":"ee1ec0d4d53b54a5","type":"remote-config","name":"Smart Agriculture Shallot System","host":"localhost","protocol":"http","port":"1880","baseurl":"/ui","instancehash":"4ivztgf0804o0wx9mk2saghygxxgmf8vpd18ibnf3j1ch7411kxh8svy7y113y56","server":"nodered03.remote-red.com","region":"us"},{"id":"d0d4883bc2e966fc","type":"ui_group","name":"pH Balancer Automation Dashboard","tab":"ea17d14df6885fe4","order":7,"disp":true,"width":"10","collapse":false,"className":""},{"id":"601fe907e912562c","type":"ui_group","name":"View Saved Data","tab":"ea17d14df6885fe4","order":11,"disp":true,"width":"30","collapse":false,"className":""},{"id":"fb0aa8ebcb6c9901","type":"ui_group","name":"Manual Operation","tab":"ea17d14df6885fe4","order":9,"disp":true,"width":"10","collapse":false,"className":""},{"id":"79af5a6d262b719f","type":"ui_group","name":"Warning Setting","tab":"ea17d14df6885fe4","order":3,"disp":true,"width":"10","collapse":false,"className":""},{"id":"a78311fe38ed89d0","type":"node-red-contrib-whatsapp-cmb-account","name":"Field Monitoring System"},{"id":"2d49b59fdcc351e9","type":"ui_group","name":"Time Period Chart","tab":"ea17d14df6885fe4","order":10,"disp":true,"width":"30","collapse":false,"className":""},{"id":"41ba8870009b0f96","type":"ui_group","name":"Fuzzy Automation Warning System","tab":"ea17d14df6885fe4","order":8,"disp":true,"width":"10","collapse":false,"className":""},{"id":"dfaa0a7552b761eb","type":"ui_group","name":"Warning Log","tab":"ea17d14df6885fe4","order":1,"disp":true,"width":"30","collapse":false,"className":""},{"id":"1c25415d.b8427f","type":"sqlitedb","db":"SENSORDATA"},{"id":"ea17d14df6885fe4","type":"ui_tab","name":"Board Information","icon":"dashboard","order":1,"disabled":false,"hidden":false}]